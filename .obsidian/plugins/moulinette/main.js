/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MoulinettePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian9 = require("obsidian");

// src/moulinette-entities.ts
var _MoulinetteAsset = class {
  constructor(path) {
    this.path = path;
  }
  getUrl(pack) {
    return `${pack.path}/${this.path}?${pack.sas ? pack.sas : ""}`;
  }
  getType() {
    return _MoulinetteAsset.TYPE_NONE;
  }
  static fromDict(obj) {
    const asset = new _MoulinetteAsset();
    if (typeof obj === "string" || obj instanceof String) {
      asset.path = obj.toString();
      const ext = asset.path.split(".").pop();
      if (["webp"].includes(ext)) {
        return new MoulinetteImage(asset.path);
      } else if (["ogg", "mp3"].includes(ext)) {
        return new MoulinetteSound(asset.path);
      } else if (["md"].includes(ext)) {
        return new MoulinetteText(asset.path);
      }
    } else if (["snd", "md"].includes(obj.type) && obj.path) {
      switch (obj.type) {
        case "snd":
          const sound = new MoulinetteSound(obj.path);
          sound.duration = obj.duration;
          return sound;
        case "md":
          const markdown = new MoulinetteText(obj.path);
          if (obj.meta && obj.meta.description)
            markdown.description = obj.meta.description;
          if (obj.meta && obj.meta.type)
            markdown.type = obj.meta.type;
          if (obj.meta && obj.meta.subtype)
            markdown.subtype = obj.meta.subtype;
          return markdown;
      }
    }
    return null;
  }
};
var MoulinetteAsset = _MoulinetteAsset;
MoulinetteAsset.TYPE_NONE = 0;
MoulinetteAsset.TYPE_IMAGE = 1;
MoulinetteAsset.TYPE_AUDIO = 2;
MoulinetteAsset.TYPE_TEXT = 3;
var MoulinetteImage = class extends MoulinetteAsset {
  getType() {
    return MoulinetteAsset.TYPE_IMAGE;
  }
};
var MoulinetteSound = class extends MoulinetteAsset {
  getType() {
    return MoulinetteAsset.TYPE_AUDIO;
  }
};
var MoulinetteText = class extends MoulinetteAsset {
  getType() {
    return MoulinetteAsset.TYPE_TEXT;
  }
  getUrl(pack) {
    return `/assets/download-asset/SESSIONID/${pack.id}?file=${this.path}&ms=${new Date().getTime()}`;
  }
};
var MoulinettePack = class {
  static fromDict(obj) {
    const pack = new MoulinettePack();
    if (obj.id) {
      pack.id = obj.id;
    }
    if (obj.name) {
      pack.name = obj.name;
    }
    if (obj.path) {
      pack.path = obj.path;
      if (obj.path.endsWith(".git")) {
        pack.packId = obj.path.split("/").pop().slice(0, -4);
      }
    }
    if (obj.sas) {
      pack.sas = obj.sas;
    }
    if (obj.assets) {
      pack.assets = [];
      for (const a of obj.assets) {
        const asset = MoulinetteAsset.fromDict(a);
        if (asset) {
          pack.assets.push(asset);
        }
      }
    }
    return pack;
  }
};
var MoulinetteCreator = class {
  static fromDict(obj) {
    const creator = new MoulinetteCreator();
    if (obj.publisher) {
      creator.name = obj.publisher;
    }
    if (obj.packs) {
      creator.packs = [];
      for (const p of obj.packs) {
        const pack = MoulinettePack.fromDict(p);
        if (pack.assets.length > 0) {
          creator.packs.push(pack);
        }
      }
    }
    return creator;
  }
  static importCreators(obj) {
    if (!obj)
      return [];
    const creators = [];
    for (const c of obj) {
      const creator = MoulinetteCreator.fromDict(c);
      if (creator.packs.length > 0) {
        creators.push(creator);
      }
    }
    return creators;
  }
};

// src/moulinette-client.ts
var import_obsidian = require("obsidian");
var _MoulinetteClient = class {
  /*
   * Sends a request to server and returns the response
   */
  static async requestServer(URI, method, data) {
    let params = { url: `${_MoulinetteClient.SERVER_URL}${URI}`, method, headers: _MoulinetteClient.HEADERS, body: data ? JSON.stringify(data) : void 0 };
    const response = await (0, import_obsidian.requestUrl)(params).catch(function(e) {
      console.error(`MoulinetteClient | Cannot establish connection to server ${_MoulinetteClient.SERVER_URL}`, e);
      return null;
    });
    return response;
  }
  /*
   * Sends a request to server and return the response or null (if server unreachable)
   */
  static async send(URI, method, data) {
    const response = await this.requestServer(URI, method, data);
    if (!response) {
      return null;
    }
    return { "status": response.status, "data": await response.json };
  }
  static async get(URI) {
    return _MoulinetteClient.send(URI, "GET", null);
  }
  static async post(URI, data) {
    return this.send(URI, "POST", data);
  }
  /** ================================================================ */
  /**
   * Retrieves user details (name, tiers, etc.)
   */
  static async getUser(userId, forceRefresh = false) {
    const noCache = "?ms=" + new Date().getTime();
    const refresh = forceRefresh ? "force=1" : "";
    return await _MoulinetteClient.get(`/user/${userId}${noCache}&${refresh}`);
  }
  /**
   * Retrieves user assets (images, markdowns, etc.)
   */
  static async getUserAssets(userId) {
    userId = userId && userId.length == 26 ? userId : "demouser";
    const result = await _MoulinetteClient.get(`/assets/${userId}?client=obsidian&ms=${new Date().getTime()}`);
    if (result && result.status == 200) {
      return MoulinetteCreator.importCreators(result.data);
    } else {
      return [];
    }
  }
};
var MoulinetteClient = _MoulinetteClient;
MoulinetteClient.SERVER_URL = "https://assets.moulinette.cloud";
//static SERVER_URL = "http://127.0.0.1:5000"
MoulinetteClient.HEADERS = { "Accept": "application/json", "Content-Type": "application/json" };
MoulinetteClient.CLIENT_ID = "K3ofcL8XyaObRrO_5VPuzXEPnOVCIW3fbLIt6Vygt_YIM6IKxA404ZQ0pZbZ0VkB";
MoulinetteClient.REMOTE_BASE = "https://mttecloudstorage.blob.core.windows.net";

// src/moulinette-utils.ts
var import_obsidian2 = require("obsidian");
var _MoulinetteUtils = class {
  // https://upload.wikimedia.org/wikipedia/commons/4/48/Markdown-mark.svg
  // https://yoksel.github.io/url-encoder/
  //static IMAGE_ICON = `data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="%23FFF" d="M448 80c8.8 0 16 7.2 16 16V415.8l-5-6.5-136-176c-4.5-5.9-11.6-9.3-19-9.3s-14.4 3.4-19 9.3L202 340.7l-30.5-42.7C167 291.7 159.8 288 152 288s-15 3.7-19.5 10.1l-80 112L48 416.3l0-.3V96c0-8.8 7.2-16 16-16H448zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm80 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"/></svg>`
  //static TEXT_ICON = `data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="208" height="128" viewBox="0 0 208 128"><rect width="198" height="118" x="5" y="5" ry="10" stroke="%23FFF" stroke-width="10" fill="%23FFF"/><path d="M30 98V30h20l20 25 20-25h20v68H90V59L70 84 50 59v39zm125 0l-30-33h20V30h20v35h20z"/></svg>`
  //static AUDIO_ICON = `data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 75 75"><path d="M39.389,13.769 L22.235,28.606 L6,28.606 L6,47.699 L21.989,47.699 L39.389,62.75 L39.389,13.769z" style="stroke:%23FFF;stroke-width:5;stroke-linejoin:round;fill:%23FFF;"/><path d="M48,27.6a19.5,19.5 0 0 1 0,21.4M55.1,20.5a30,30 0 0 1 0,35.6M61.6,14a38.8,38.8 0 0 1 0,48.6" style="fill:none;stroke:%23FFF;stroke-width:5;stroke-linecap:round"/></svg>`
  /**
   * Improves name (originally a filepath) by replacing separators
   */
  static beautifyName(name) {
    name = name.replace(/[_-]/g, " ");
    name = name.indexOf(".") > 0 ? name.substring(0, name.indexOf(".")) : name;
    name = name.split(" ").map((word) => {
      return word.length < 2 ? word : word[0].toUpperCase() + word.substring(1);
    }).join(" ");
    return name;
  }
  /**
   * This utility function downloads a remote image (from Moulinette Cloud)
   * Into a specific folder (under /moulinette)
   * 
   * @param vault current Vault
   * @param url image URL
   * @returns image path within the vault
   */
  static async downloadFile(vault, url) {
    let imagePath = url;
    if (url.startsWith(MoulinetteClient.REMOTE_BASE)) {
      imagePath = _MoulinetteUtils.PREFIX + url.substring(MoulinetteClient.REMOTE_BASE.length + 1, url.lastIndexOf("?"));
    } else if (url.startsWith(MoulinetteClient.SERVER_URL)) {
      const idx = url.lastIndexOf("?file=");
      if (idx > 0) {
        imagePath = _MoulinetteUtils.PREFIX + url.split("?file=")[1];
      } else {
        console.warn(`Invalid URL: ${url}`);
        return null;
      }
    }
    const folderPath = imagePath.substring(0, imagePath.lastIndexOf("/"));
    if (!await vault.adapter.exists((0, import_obsidian2.normalizePath)(folderPath))) {
      vault.createFolder(folderPath);
    }
    if (!await vault.adapter.exists((0, import_obsidian2.normalizePath)(imagePath))) {
      await (0, import_obsidian2.requestUrl)(url).then((response) => {
        if (response.status != 200) {
          throw new Error(`HTTP ${response.status} - ${response.text}`);
        }
        return response.arrayBuffer;
      }).then((buffer) => {
        vault.createBinary(imagePath, buffer);
      }).catch((err) => {
        console.error("Moulinette | Couldn't download the image!", err);
        return null;
      });
    } else {
      console.warn("Moulinette | File already exists. ", imagePath);
    }
    return imagePath;
  }
  /**
   * This utility function downloads a markdown content (from Moulinette Cloud)
   * 
   * @param vault current vault
   * @param creators cached creators
   * @param url markdown URL
   * @returns markdown content
   */
  static async downloadMarkdown(plugin, uri) {
    let markdownContent = "";
    const sessionId = plugin.settings.sessionID ? plugin.settings.sessionID : "demo-user";
    await MoulinetteClient.requestServer(uri.replace("SESSIONID", sessionId), "get", null).then((response) => {
      if (!response) {
        throw new Error(`Error during request`);
      }
      if (response.status != 200) {
        throw new Error(`HTTP ${response.status} - ${response.text}`);
      }
      return response.text;
    }).then((text) => {
      markdownContent = text;
    }).catch((err) => {
      console.error("Moulinette | Couldn't download the markdown!", err);
    });
    return await _MoulinetteUtils.downloadDependencies(plugin, markdownContent);
  }
  /**
   * Checks the entire markdown content for references ![[some URL]]
   * Download the references if exist on Moulinette
   * 
   * @param vault current vault
   * @param creators  cached creators
   * @param markdown markdown content
   */
  static async downloadDependencies(plugin, markdown) {
    let newMarkdown = markdown;
    const matches = markdown.matchAll(/(\!?)\[\[([^\]]+)\]\]/g);
    for (const match of matches) {
      const refMark = match[1];
      let assetPath = match[2];
      const creators = await plugin.getCreators();
      if (assetPath.startsWith(_MoulinetteUtils.PREFIX)) {
        assetPath = assetPath.substring(_MoulinetteUtils.PREFIX.length);
        const creatorPath = assetPath.split("/")[0];
        const pack = assetPath.split("/")[1];
        const baseURL = `${creatorPath}/${pack}`;
        for (const c of creators) {
          const pack2 = c.packs.find((p) => p.path.endsWith(baseURL));
          if (pack2) {
            if (refMark == "!") {
              const url = `${pack2.path}${assetPath.replace(baseURL, "")}?${pack2.sas ? pack2.sas : ""}`;
              await _MoulinetteUtils.downloadFile(plugin.app.vault, url);
            }
          }
        }
      } else {
        const packId = assetPath.split("/")[0];
        for (const c of creators) {
          const pack = c.packs.find((p) => p.packId == packId);
          if (pack) {
            let path = null;
            if (refMark == "!") {
              const sessionId = plugin.settings.sessionID ? plugin.settings.sessionID : "demo-user";
              const url = `${MoulinetteClient.SERVER_URL}/assets/download-asset/${sessionId}/${pack.id}?file=${assetPath}&ms=${new Date().getTime()}`;
              path = await _MoulinetteUtils.downloadFile(plugin.app.vault, url);
            } else {
              path = _MoulinetteUtils.PREFIX + (assetPath.startsWith("/") ? assetPath.substring(1) : assetPath);
            }
            if (path) {
              newMarkdown = newMarkdown.replace(match[0], `${refMark}[[${path}]]`);
              break;
            }
          }
        }
      }
    }
    return newMarkdown;
  }
  /**
   * Converts a duration into a string representation
   * @param duration duration as number of seconds
   * @returns string representation of the duration (65 sec = 1:05)
   */
  static formatDuration(duration) {
    const durHr = Math.floor(duration / 3600);
    const durMin = Math.floor((duration - 3600 * durHr) / 60);
    const durSec = duration % 60;
    return (durHr > 0 ? `${durHr}:${durMin.toString().padStart(2, "0")}` : durMin.toString()) + ":" + durSec.toString().padStart(2, "0");
  }
  /**
   * Merge packs with same name
   */
  static combinePacks(packs) {
    let newPacks = {};
    for (const p of packs) {
      let name = p.name.trim();
      if (name.endsWith("HD") || name.endsWith("4K")) {
        name = name.slice(0, -2).trim();
      }
      name = name.replace(/\([^\)]+\)/g, "").trim();
      if (name in newPacks) {
        newPacks[name].push(p);
      } else {
        newPacks[name] = [p];
      }
    }
    return newPacks;
  }
};
var MoulinetteUtils = _MoulinetteUtils;
MoulinetteUtils.PREFIX = "moulinette/";

// src/moulinette-results.ts
var import_obsidian3 = require("obsidian");
var MoulinetteAssetResult = class {
  // additional metadata
  /**
   * Generates a Result instance from a given entity
   */
  static fromEntity(a, p, c) {
    const res = new MoulinetteAssetResult();
    res.name = MoulinetteUtils.beautifyName(a.path.split("/").pop() || "");
    res.pack = p.name;
    res.creator = c.name;
    res.ref = a;
    if (a instanceof MoulinetteImage) {
      res.url = a.getUrl(p);
      res.thumbUrl = `${p.path}/${a.path.split(".").slice(0, -1).join(".")}_thumb.webp?${p.sas ? p.sas : ""}`;
    } else if (a instanceof MoulinetteSound) {
      res.url = a.getUrl(p);
    } else if (a instanceof MoulinetteText) {
      res.url = a.getUrl(p);
    } else {
      return null;
    }
    return res;
  }
  /**
   * Generates a View for this result
   */
  renderHTML(modal, containerEl) {
    const asset = containerEl.createEl("div", { cls: "asset" });
    switch (this.ref.constructor.name) {
      case "MoulinetteImage":
        asset.createEl("img").setAttribute("src", this.thumbUrl);
        break;
      case "MoulinetteSound":
        (0, import_obsidian3.setIcon)(asset.createDiv({ cls: "icon" }), "music");
        break;
      case "MoulinetteText":
        (0, import_obsidian3.setIcon)(asset.createDiv({ cls: "icon" }), "file-text");
        break;
    }
    const info = asset.createEl("div", { cls: "info" });
    info.createEl("div", { text: this.name, cls: "title" });
    info.createEl("div", { text: `${this.pack} (${this.creator})`, cls: "pack" });
    if (this.ref instanceof MoulinetteText) {
      if (this.ref.description) {
        info.createEl("div", { text: this.ref.description, cls: "desc" });
      }
      if (this.ref.type) {
        const tags = info.createDiv("meta");
        const typeVal = this.ref.type;
        tags.createEl("div", { text: typeVal, cls: "tag", title: "Type" }).addEventListener("click", (ev) => {
          ev.stopPropagation();
          modal.applyFilter("type", typeVal);
        });
        if (this.ref.subtype) {
          const subtypeVal = this.ref.subtype;
          tags.createEl("div", { text: subtypeVal, cls: "tag", title: "Subtype" }).addEventListener("click", (ev) => {
            ev.stopPropagation();
            modal.applyFilter("subtype", subtypeVal);
          });
        }
      }
    }
  }
};

// src/moulinette-search.ts
var import_obsidian4 = require("obsidian");
var _MoulinetteFilters = class {
  constructor(query) {
    this.assetType = _MoulinetteFilters.ASSET_TYPE_ANY;
    this.tags = [];
    this.terms = [];
    const terms = query.split(" ");
    for (const t of terms) {
      if (t.length == 0)
        continue;
      else if (t == "!")
        continue;
      else if (t == "!i" || t == "i!")
        this.assetType = _MoulinetteFilters.ASSET_TYPE_IMAGES;
      else if (t == "!s" || t == "s!")
        this.assetType = _MoulinetteFilters.ASSET_TYPE_SOUNDS;
      else if (t == "!t" || t == "t!")
        this.assetType = _MoulinetteFilters.ASSET_TYPE_TEXT;
      else if (t.startsWith("#")) {
        const tag = t.substring(1).split(":");
        if (tag.length == 2) {
          this.tags.push({ id: tag[0], value: tag[1] });
        }
      } else {
        this.terms.push(t);
      }
    }
  }
  matches(asset) {
    if (this.assetType == _MoulinetteFilters.ASSET_TYPE_IMAGES && !(asset instanceof MoulinetteImage))
      return false;
    if (this.assetType == _MoulinetteFilters.ASSET_TYPE_SOUNDS && !(asset instanceof MoulinetteSound))
      return false;
    if (this.assetType == _MoulinetteFilters.ASSET_TYPE_TEXT && !(asset instanceof MoulinetteText))
      return false;
    if (this.tags.length > 0) {
      if (!(asset instanceof MoulinetteText))
        return false;
      for (const t of this.tags) {
        if (t.id == "type" && asset.type != t.value)
          return false;
        if (t.id == "subtype" && asset.subtype != t.value)
          return false;
      }
    }
    for (const t of this.terms) {
      if (asset.path && asset.path.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()) >= 0)
        continue;
      if (asset instanceof MoulinetteText && asset.description && asset.description.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()) >= 0)
        continue;
      return false;
    }
    return true;
  }
};
var MoulinetteFilters = _MoulinetteFilters;
MoulinetteFilters.ASSET_TYPE_ANY = 0;
MoulinetteFilters.ASSET_TYPE_IMAGES = 1;
// "!i"
MoulinetteFilters.ASSET_TYPE_SOUNDS = 2;
// "!s"
MoulinetteFilters.ASSET_TYPE_TEXT = 3;
var _MoulinetteSearchModal = class extends import_obsidian4.SuggestModal {
  constructor(plugin, creators) {
    super(plugin.app);
    this.plugin = plugin;
    this.creators = creators;
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    const filters = new MoulinetteFilters(query);
    const results = [];
    for (const c of this.creators) {
      for (const p of c.packs) {
        for (const a of p.assets) {
          if (filters.matches(a)) {
            const result = MoulinetteAssetResult.fromEntity(a, p, c);
            if (result) {
              results.push(result);
              if (results.length >= _MoulinetteSearchModal.MAX_RESULTS) {
                return results;
              }
            }
          }
        }
      }
    }
    return results;
  }
  // Renders each suggestion item.
  renderSuggestion(res, el) {
    res.renderHTML(this, el);
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(res, evt) {
    if (res.url.startsWith(MoulinetteClient.REMOTE_BASE)) {
      MoulinetteUtils.downloadFile(this.plugin.app.vault, res.url).then((imgPath) => {
        const view = this.plugin.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
        if (imgPath && view) {
          view.editor.replaceSelection(`![[${imgPath}]]`);
        } else {
          navigator.clipboard.writeText(`![[${imgPath}]]`).then(() => {
            new import_obsidian4.Notice("No active view. Path copied into clipboard");
          }).catch(() => {
            new import_obsidian4.Notice("No active view AND cannot write into clipboard");
          });
        }
      });
    } else {
      MoulinetteUtils.downloadMarkdown(this.plugin, res.url).then((mdText) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
        if (mdText && view) {
          view.editor.replaceSelection(mdText);
        } else {
          navigator.clipboard.writeText(mdText).then(() => {
            new import_obsidian4.Notice("No active view. Text copied into clipboard");
          }).catch(() => {
            new import_obsidian4.Notice("No active view AND cannot write into clipboard");
          });
        }
      });
    }
  }
  applyFilter(tagName, tagValue) {
    const query = this.inputEl.value;
    const idx = query.indexOf(`#${tagName}:`);
    if (idx >= 0) {
      let newQuery = query.substring(0, idx) + `#${tagName}:${tagValue}`;
      const idE = query.indexOf(" ", idx + 1);
      if (idE >= 0) {
        newQuery += query.substring(idE);
      }
    } else {
      this.inputEl.setRangeText(` #${tagName}:${tagValue}`);
    }
    this.inputEl.selectionStart = this.inputEl.selectionEnd = this.inputEl.value.length;
    this.inputEl.dispatchEvent(new Event("input", { bubbles: true }));
  }
};
var MoulinetteSearchModal = _MoulinetteSearchModal;
MoulinetteSearchModal.MAX_RESULTS = 100;

// src/moulinette-settings.ts
var import_obsidian5 = require("obsidian");
var import_obsidian6 = require("obsidian");
var import_crypto = require("crypto");
var MoulinetteSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.intervalRef = 0;
    this.intervalIter = 0;
  }
  /**
   * Extra cleanup : make sure no authentication in progress
   */
  hide() {
    if (this.intervalRef) {
      window.clearInterval(this.intervalRef);
    }
    this.warn.removeClass("visible");
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian5.Setting(containerEl).setName("Download folder").setDesc("Name of the directory where the files will be downloaded.").addText((text) => text.setPlaceholder("moulinette").setValue(this.plugin.settings.downloadFolder).onChange(async (value) => {
      this.plugin.settings.downloadFolder = value && value.length > 0 ? value : "moulinette";
      MoulinetteUtils.PREFIX = this.plugin.settings.downloadFolder + "/";
      await this.plugin.saveSettings();
    }));
    new import_obsidian5.Setting(containerEl).setName("Moulinette Cloud integration").setHeading();
    this.refreshCloudIntegration(containerEl.createDiv({ cls: "setting-item" }));
    const refreshSetting = containerEl.createDiv({ cls: "setting-item" });
    const authInfo = refreshSetting.createDiv({ cls: "setting-item-info" });
    authInfo.createDiv({ cls: "setting-item-name", text: `Refresh assets` });
    authInfo.createDiv({ cls: "setting-item-description", text: "The list of assets you have access to is cached. Click the 'Refresh' button to force a data refresh without the need to restart Obsidian." });
    const actions = refreshSetting.createDiv({ cls: "setting-item-control" }).createDiv("actions");
    const refreshButton = new import_obsidian5.ButtonComponent(actions).setButtonText("Refresh").onClick(async () => {
      refreshButton.setButtonText("\u2713 refreshed!");
      refreshButton.setDisabled(true);
      refreshButton.setClass("success");
      this.plugin.clearCache();
    });
  }
  /**
   * Updates the cloud integration settings section
   * 
   * @param settingDIV DIV element to update
   */
  async refreshCloudIntegration(settingDIV, force = false) {
    settingDIV.empty();
    const authInfo = settingDIV.createDiv({ cls: "setting-item-info" });
    if (this.plugin.settings.sessionID && this.plugin.settings.sessionID.length == 26) {
      const user = await MoulinetteClient.getUser(this.plugin.settings.sessionID, force);
      if (user && user.status == 200) {
        if (user.data.guid) {
          this.plugin.settings.sessionID = user.data.guid;
          await this.plugin.saveSettings();
          delete user.data.guid;
        }
        if (user.data.patron) {
          authInfo.createDiv({ cls: "setting-item-name", text: `Authenticated as '${user.data.fullName}' (#${user.data.id}) and supporting Moulinette \u2665` });
          const descr = authInfo.createDiv({ cls: "setting-item-description" });
          descr.createSpan({ text: "Tiers :" });
          const ul = descr.createEl("ul");
          for (const pledge of user.data.pledges) {
            const li = ul.createEl("li");
            li.createDiv({ text: `${pledge.vanity}: ${pledge.pledge}` });
          }
          const authCtrl = settingDIV.createDiv({ cls: "setting-item-control" });
          const actions = authCtrl.createDiv("actions");
          new import_obsidian5.ButtonComponent(actions).setButtonText("Refresh tiers").onClick(async () => {
            this.plugin.clearCache();
            this.refreshCloudIntegration(settingDIV, true);
          });
          new import_obsidian5.ButtonComponent(actions).setButtonText("Logout").onClick(async () => {
            this.plugin.settings.sessionID = "";
            await this.plugin.saveSettings();
            this.plugin.clearCache();
            this.refreshCloudIntegration(settingDIV);
          });
        } else {
          authInfo.createDiv({ cls: "setting-item-name", text: `Authenticated as '${user.data.fullName}' (#${user.data.id}), not a Moulinette member` });
          const descr = authInfo.createDiv({ cls: "setting-item-description" });
          descr.createSpan({ text: "Moulinette support is required for accessing cloud features. Nevertheless, you can still utilize the module with the available demo data." });
          const actions = settingDIV.createDiv({ cls: "setting-item-control" }).createDiv("actions");
          new import_obsidian5.ButtonComponent(actions).setButtonText("Join Moulinette").onClick(async () => {
            window.open("https://www.patreon.com/join/moulinette", "_blank");
          });
          new import_obsidian5.ButtonComponent(actions).setButtonText("Refresh tiers").onClick(async () => {
            this.plugin.clearCache();
            this.refreshCloudIntegration(settingDIV, true);
          });
          new import_obsidian5.ButtonComponent(actions).setButtonText("Logout").onClick(async () => {
            this.plugin.settings.sessionID = "";
            this.plugin.clearCache();
            await this.plugin.saveSettings();
            this.refreshCloudIntegration(settingDIV);
          });
        }
      }
    } else {
      const newGUID = (0, import_crypto.randomUUID)().replace(/-/g, "").substring(0, 26);
      const callback = `${MoulinetteClient.SERVER_URL}/patreon/callback`;
      const patreonURL = `https://www.patreon.com/oauth2/authorize?response_type=code&client_id=${MoulinetteClient.CLIENT_ID}&redirect_uri=${callback}&scope=identity identity.memberships&state=${newGUID}`;
      authInfo.createDiv({ cls: "setting-item-name", text: "Your Vault is not linked to Moulinette yet" });
      const descr = authInfo.createDiv({ cls: "setting-item-description" });
      descr.createEl("span", { text: "By linking your Vault to Moulinette, you will be able to easily search and download content from creators and communities. " });
      descr.createEl("a", { href: "https://www.moulinette.cloud/", text: "Learn more about Moulinette" });
      this.warn = descr.createDiv({ cls: "setting-warning", text: "Authentication in progress in your web browser. You have 2 minutes to complete the process!" });
      const authCtrl = settingDIV.createDiv({ cls: "setting-item-control" });
      const button = new import_obsidian5.ButtonComponent(authCtrl.createDiv("actions")).setButtonText("Authenticate").onClick(async () => {
        window.open(patreonURL, "_blank");
        this.warn.addClass("visible");
        this.intervalIter = 120;
        this.intervalRef = window.setInterval(async () => {
          if (this.intervalIter <= 0) {
            button.setButtonText(`Retry`);
            return window.clearInterval(this.intervalRef);
          }
          this.intervalIter--;
          button.setButtonText(`${this.intervalIter} sec`);
          if (this.intervalIter % 2) {
            const ready = await MoulinetteClient.get(`/user/${newGUID}/ready?patreon=1`);
            if (ready && ready.status == 200 && ready.data.status == "yes") {
              window.clearInterval(this.intervalRef);
              this.plugin.settings.sessionID = newGUID;
              await this.plugin.saveSettings();
              this.plugin.clearCache();
              this.refreshCloudIntegration(settingDIV);
            }
          }
        }, 1e3);
      });
    }
  }
};

// src/moulinette-browser.ts
var import_obsidian7 = require("obsidian");
var MoulinetteBrowserFilters = class {
  constructor() {
    this.creator = -1;
    this.packs = [];
    this.type = 0;
    this.terms = "";
  }
};
var _MoulinetteBrowser = class extends import_obsidian7.Modal {
  // timer to delay keyup event
  constructor(plugin, creators, filters) {
    super(plugin.app);
    this.plugin = plugin;
    this.creators = creators.sort((a, b) => a.name.toLocaleLowerCase().localeCompare(b.name.toLocaleLowerCase()));
    this.filters = filters ? filters : new MoulinetteBrowserFilters();
    this.keyUpTimerRef = 0;
  }
  onOpen() {
    var _a;
    let { contentEl } = this;
    (_a = contentEl.parentElement) == null ? void 0 : _a.addClass("browser");
    const headerEl = contentEl.createEl("div", { cls: "searchbar" });
    const searchEl = headerEl.createEl("input", { value: this.filters.terms, placeholder: "Search ..." });
    searchEl.addEventListener("keyup", () => {
      if (this.keyUpTimerRef)
        window.clearTimeout(this.keyUpTimerRef);
      this.keyUpTimerRef = window.setTimeout(() => {
        this.filters.terms = searchEl.value;
        this.updateData(true);
      }, _MoulinetteBrowser.SEARCH_DELAY);
    });
    const creatorsEl = headerEl.createEl("select", {});
    creatorsEl.createEl("option", { value: "-1", text: `-- Creators --` });
    this.creators.forEach((c, idx) => {
      const count = c.packs.reduce((acc, objet) => acc + objet.assets.length, 0);
      const option = creatorsEl.createEl("option", { value: "" + idx, text: `${c.name} (${count.toLocaleString()})` });
      if (this.filters.creator == idx) {
        option.setAttribute("selected", "selected");
      }
    });
    const packsEl = headerEl.createEl("select", {});
    packsEl.createEl("option", { value: "", text: `-- Pack --` });
    creatorsEl.addEventListener("change", (ev) => {
      this.filters.creator = Number(ev.target.value);
      this.filters.packs = [];
      this.onSelectCreator(packsEl);
      this.updateData(true);
    });
    packsEl.addEventListener("change", (ev) => {
      const selPacksValue = ev.target.value;
      this.filters.packs = selPacksValue.length == 0 ? [] : selPacksValue.split(",").map(function(item) {
        return parseInt(item, 10);
      });
      this.updateData(true);
    });
    const imageButton = headerEl.createEl("button", { cls: this.filters.type == MoulinetteAsset.TYPE_IMAGE ? "highlight" : "" });
    (0, import_obsidian7.setIcon)(imageButton, "image");
    const audioButton = headerEl.createEl("button", { cls: this.filters.type == MoulinetteAsset.TYPE_AUDIO ? "highlight" : "" });
    (0, import_obsidian7.setIcon)(audioButton, "music");
    const mdButton = headerEl.createEl("button", { cls: this.filters.type == MoulinetteAsset.TYPE_TEXT ? "highlight" : "" });
    (0, import_obsidian7.setIcon)(mdButton, "file-text");
    imageButton.addEventListener("click", (ev) => this.applyTypeFilter(MoulinetteAsset.TYPE_IMAGE, imageButton, audioButton, mdButton));
    audioButton.addEventListener("click", (ev) => this.applyTypeFilter(MoulinetteAsset.TYPE_AUDIO, imageButton, audioButton, mdButton));
    mdButton.addEventListener("click", (ev) => this.applyTypeFilter(MoulinetteAsset.TYPE_TEXT, imageButton, audioButton, mdButton));
    this.assetsEl = contentEl.createDiv("assets");
    this.assetsEl.addEventListener("scroll", (ev) => {
      if (this.ignoreScroll)
        return;
      const bottom = this.assetsEl.scrollHeight - this.assetsEl.scrollTop;
      const height = this.assetsEl.clientHeight;
      if (bottom - 20 < height) {
        this.ignoreScroll = true;
        if (this.page >= 0) {
          this.page++;
          this.updateData(false);
        }
        this.ignoreScroll = false;
      }
    });
    const footer = contentEl.createDiv({ cls: "footer" });
    const icon = footer.createDiv("div");
    (0, import_obsidian7.setIcon)(icon, "info");
    footer.createSpan({ text: "Hold CTRL/Command key to download multiple assets." });
    this.onSelectCreator(packsEl);
    this.updateData(true);
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
    this.plugin.lastFilters = this.filters;
    if (this.keyUpTimerRef)
      window.clearTimeout(this.keyUpTimerRef);
  }
  /**
   * Updates the packs list
   * @param packsEl HTML select list
   */
  onSelectCreator(packsEl) {
    packsEl.empty();
    packsEl.createEl("option", { value: "", text: `-- Packs --` });
    if (this.filters.creator >= 0) {
      const packs = MoulinetteUtils.combinePacks(this.creators[this.filters.creator].packs);
      const sortedNames = Object.keys(packs).sort((a, b) => a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase()));
      const selected = this.filters.packs.join();
      for (const sn of sortedNames) {
        const values = packs[sn].map((p) => p.id).join();
        const count = packs[sn].reduce((acc, cur) => acc + cur.assets.length, 0);
        const option = packsEl.createEl("option", { value: values, text: `${sn} (${count.toLocaleString()})` });
        if (selected == values) {
          option.setAttribute("selected", "selected");
        }
      }
    }
  }
  applyTypeFilter(type, imageButton, audioButton, mdButton) {
    this.filters.type = this.filters.type == type ? 0 : type;
    if (this.filters.type == MoulinetteAsset.TYPE_IMAGE) {
      imageButton.addClass("highlight");
    } else {
      imageButton.removeClass("highlight");
    }
    if (this.filters.type == MoulinetteAsset.TYPE_AUDIO) {
      audioButton.addClass("highlight");
    } else {
      audioButton.removeClass("highlight");
    }
    if (this.filters.type == MoulinetteAsset.TYPE_TEXT) {
      mdButton.addClass("highlight");
    } else {
      mdButton.removeClass("highlight");
    }
    this.updateData(true);
  }
  generateAssetHTML(pack, asset, assetId) {
    var _a;
    if (asset instanceof MoulinetteImage) {
      const url = `${pack.path}/${asset.path}`.replace(".webp", "_thumb.webp") + (pack.sas ? "?" + pack.sas : "");
      const thumb = this.assetsEl.createEl("img");
      thumb.setAttribute("src", url);
      thumb.setAttribute("title", asset.path);
      thumb.addEventListener("click", (ev) => {
        const assetURL = `${pack.path}/${asset.path}?` + (pack.sas ? pack.sas : "");
        MoulinetteUtils.downloadFile(this.app.vault, assetURL).then((imgPath) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
          if (imgPath && view) {
            view.editor.replaceSelection(`![[${imgPath}]]`);
          } else {
            navigator.clipboard.writeText(`![[${imgPath}]]`).then(() => {
              new import_obsidian7.Notice("No active view. Path copied into clipboard");
            }).catch(() => {
              new import_obsidian7.Notice("No active view AND cannot write into clipboard");
            });
          }
          if (!ev.ctrlKey) {
            this.close();
          } else {
            new import_obsidian7.Notice(`Image ${imgPath == null ? void 0 : imgPath.split("/").pop()} downloaded`);
          }
        });
      });
    } else if (asset instanceof MoulinetteSound) {
      const assetEl = this.assetsEl.createDiv({ cls: "snd" });
      assetEl.setAttribute("title", asset.path);
      const thumb = assetEl.createDiv();
      (0, import_obsidian7.setIcon)(thumb, "music");
      const filename = (_a = asset.path.split("/").pop()) == null ? void 0 : _a.split(".")[0];
      assetEl.createEl("div", { cls: "dur", text: MoulinetteUtils.formatDuration(asset.duration) });
      assetEl.createEl("div", { text: filename });
      assetEl.addEventListener("click", (ev) => {
        const assetURL = asset.getUrl(pack);
        MoulinetteUtils.downloadFile(this.app.vault, assetURL).then((sndPath) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
          if (sndPath && view) {
            view.editor.replaceSelection(`![[${sndPath}]]`);
          } else {
            navigator.clipboard.writeText(`![[${sndPath}]]`).then(() => {
              new import_obsidian7.Notice("No active view. Path copied into clipboard");
            }).catch(() => {
              new import_obsidian7.Notice("No active view AND cannot write into clipboard");
            });
          }
          if (!ev.ctrlKey) {
            this.close();
          } else {
            new import_obsidian7.Notice(`Sound ${sndPath == null ? void 0 : sndPath.split("/").pop()} downloaded`);
          }
        });
      });
    } else if (asset instanceof MoulinetteText) {
      const assetEl = this.assetsEl.createDiv({ cls: "md" });
      assetEl.setAttribute("title", asset.path);
      const thumb = assetEl.createDiv();
      (0, import_obsidian7.setIcon)(thumb, "file-text");
      const filename = asset.path.split("/").pop();
      assetEl.createEl("div", { text: (filename == null ? void 0 : filename.endsWith(".md")) ? filename.slice(0, -3) : filename });
      assetEl.addEventListener("click", (ev) => {
        const assetURL = asset.getUrl(pack);
        MoulinetteUtils.downloadMarkdown(this.plugin, assetURL).then((mdText) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
          if (mdText && view) {
            view.editor.replaceSelection(mdText);
          } else {
            navigator.clipboard.writeText(mdText).then(() => {
              new import_obsidian7.Notice("No active view. Text copied into clipboard");
            }).catch(() => {
              new import_obsidian7.Notice("No active view AND cannot write into clipboard");
            });
          }
          if (!ev.ctrlKey) {
            this.close();
          } else {
            new import_obsidian7.Notice(`Text ${asset.path} downloaded`);
          }
        });
      });
    }
  }
  updateData(clear) {
    if (clear) {
      this.assetsEl.empty();
      this.page = 0;
    }
    let assetIdx = 0;
    let noAddition = true;
    const terms = this.filters.terms.length > 0 ? this.filters.terms.toLocaleLowerCase().split(" ") : null;
    const creators = this.filters.creator >= 0 ? [this.creators[this.filters.creator]] : this.creators;
    for (const c of creators) {
      for (const p of c.packs) {
        if (this.filters.packs.length > 0 && !this.filters.packs.includes(p.id))
          continue;
        let assets = p.assets;
        if (this.filters.type) {
          assets = assets.filter((a) => this.filters.type == a.getType());
        }
        if (terms) {
          assets = assets.filter((a) => terms.filter((t) => a.path.toLocaleLowerCase().indexOf(t) >= 0).length == terms.length);
          assets.forEach((a, idx) => {
            if (assetIdx >= _MoulinetteBrowser.MAX_ASSETS * this.page && assetIdx < (this.page + 1) * _MoulinetteBrowser.MAX_ASSETS) {
              this.generateAssetHTML(p, a, idx);
              noAddition = false;
            }
            assetIdx++;
          });
        } else {
          assets.forEach((a, idx) => {
            if (assetIdx >= _MoulinetteBrowser.MAX_ASSETS * this.page && assetIdx < (this.page + 1) * _MoulinetteBrowser.MAX_ASSETS) {
              this.generateAssetHTML(p, a, idx);
              noAddition = false;
            }
            assetIdx++;
          });
        }
      }
    }
    if (noAddition) {
      this.page = -1;
    }
    if (assetIdx == 0) {
      this.assetsEl.createDiv({ text: "No results round" });
    }
  }
};
var MoulinetteBrowser = _MoulinetteBrowser;
MoulinetteBrowser.MAX_ASSETS = 100;
MoulinetteBrowser.SEARCH_DELAY = 600;

// src/moulinette-progress.ts
var import_obsidian8 = require("obsidian");
var MoulinetteProgress = class extends import_obsidian8.Modal {
  constructor(app) {
    super(app);
  }
  onOpen() {
    var _a;
    let { contentEl } = this;
    (_a = contentEl.parentElement) == null ? void 0 : _a.addClass("progress");
    contentEl.addClass("message");
    const icon = contentEl.createDiv("div");
    (0, import_obsidian8.setIcon)(icon, "hourglass");
    contentEl.createDiv({ text: "Downloading Moulinette's index... please wait!" });
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  sessionID: "",
  downloadFolder: "moulinette"
};
var _MoulinettePlugin = class extends import_obsidian9.Plugin {
  // last-used filters
  async onload() {
    await this.loadSettings();
    this.lastFilters = new MoulinetteBrowserFilters();
    this.registerEvent(this.app.vault.on("create", async (file) => {
      this.downloadPage(file);
    }));
    MoulinetteUtils.PREFIX = this.settings.downloadFolder + "/";
    this.addRibbonIcon("hammer", "Moulinette Browser", (evt) => {
      this.getCreators().then((creators) => new MoulinetteBrowser(this, creators, this.lastFilters).open());
    });
    this.addCommand({
      id: "browser",
      name: "Open Moulinette Browser",
      //hotkeys: [{ key: 'M', modifiers: ['Ctrl', 'Shift'] }],
      callback: () => {
        this.getCreators().then((creators) => new MoulinetteBrowser(this, creators, this.lastFilters).open());
      }
    });
    this.addCommand({
      id: "clear-cache",
      name: "Clear cache",
      callback: () => {
        this.clearCache();
      }
    });
    this.addCommand({
      id: "reload-page",
      name: "Re-download page",
      callback: () => {
        const curView = this.app.workspace.getActiveViewOfType(import_obsidian9.MarkdownView);
        if (curView && curView.file) {
          const lastline = curView.editor.lastLine();
          const lastCh = curView.editor.getLine(lastline).length;
          curView.editor.setSelection({ line: 0, ch: 0 }, { line: lastline, ch: lastCh });
          this.downloadPage(curView.file);
        }
      }
    });
    this.addCommand({
      id: "search",
      name: "Open Quick Search",
      //hotkeys: [{ key: 'M', modifiers: ['Ctrl'] }],
      callback: () => {
        this.getCreators().then((creators) => new MoulinetteSearchModal(this, creators).open());
      }
    });
    this.addSettingTab(new MoulinetteSettingTab(this.app, this));
    this.registerMarkdownPostProcessor((element, ctx) => {
      const targetLinks = Array.from(element.getElementsByTagName("img"));
      for (const link of targetLinks) {
        let clean_link = link.src.replace("app://obsidian.md/", "").replace("capacitor://localhost/", "");
        let full_link = this.app.vault.adapter.getResourcePath(clean_link);
        link.src = full_link;
      }
    });
  }
  onunload() {
    this.clearCache();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  /**
   * @returns list of assets
   */
  async getCreators() {
    const start = Date.now();
    if (this.creators && start - this.creatorsDate < _MoulinettePlugin.CACHE_TIMEOUT) {
      return this.creators;
    } else {
      const progress = new MoulinetteProgress(this.app);
      progress.open();
      this.creators = await MoulinetteClient.getUserAssets(this.settings.sessionID);
      progress.close();
      this.creatorsDate = start;
      return this.creators;
    }
  }
  /**
   * clear all caches
   */
  clearCache() {
    this.creators = [];
    this.creatorsDate = 0;
    new import_obsidian9.Notice("Moulinette Cache cleared!");
  }
  /**
   * download file from server (if exists)
   */
  async downloadPage(file) {
    if (file.name.endsWith(".md") && file.path.startsWith(MoulinetteUtils.PREFIX)) {
      const packId = file.path.split("/")[1];
      const creators = await this.getCreators();
      for (const c of creators) {
        const pack = c.packs.find((p) => p.packId == packId);
        const filepath = file.path.replace(MoulinetteUtils.PREFIX, "");
        if (pack) {
          const a = pack.assets.find((a2) => a2.path == filepath);
          if (a) {
            const sessionId = this.settings.sessionID ? this.settings.sessionID : "demo-user";
            const url = `/assets/download-asset/${sessionId}/${pack.id}?file=${a.path}&ms=${new Date().getTime()}`;
            MoulinetteUtils.downloadMarkdown(this, url).then((mdText) => {
              const view = this.app.workspace.getActiveViewOfType(import_obsidian9.MarkdownView);
              if (mdText && view) {
                view.editor.replaceSelection(mdText);
              }
            });
            break;
          } else {
            new import_obsidian9.Notice(`No Moulinette match found for ${file.name}!`);
          }
        }
      }
    }
  }
};
var MoulinettePlugin = _MoulinettePlugin;
MoulinettePlugin.CACHE_TIMEOUT = 1e3 * 60 * 60 * 23;
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL21vdWxpbmV0dGUtZW50aXRpZXMudHMiLCAic3JjL21vdWxpbmV0dGUtY2xpZW50LnRzIiwgInNyYy9tb3VsaW5ldHRlLXV0aWxzLnRzIiwgInNyYy9tb3VsaW5ldHRlLXJlc3VsdHMudHMiLCAic3JjL21vdWxpbmV0dGUtc2VhcmNoLnRzIiwgInNyYy9tb3VsaW5ldHRlLXNldHRpbmdzLnRzIiwgInNyYy9tb3VsaW5ldHRlLWJyb3dzZXIudHMiLCAic3JjL21vdWxpbmV0dGUtcHJvZ3Jlc3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1hcmtkb3duVmlldywgTm90aWNlLCBQbGF0Zm9ybSwgUGx1Z2luLCBUQWJzdHJhY3RGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTW91bGluZXR0ZVNlYXJjaE1vZGFsIH0gZnJvbSAnbW91bGluZXR0ZS1zZWFyY2gnO1xuaW1wb3J0IHsgTW91bGluZXR0ZUNyZWF0b3IgfSBmcm9tICdtb3VsaW5ldHRlLWVudGl0aWVzJztcbmltcG9ydCB7IE1vdWxpbmV0dGVVdGlscyB9IGZyb20gJ21vdWxpbmV0dGUtdXRpbHMnO1xuaW1wb3J0IHsgTW91bGluZXR0ZVNldHRpbmdUYWIgfSBmcm9tICdtb3VsaW5ldHRlLXNldHRpbmdzJztcbmltcG9ydCB7IE1vdWxpbmV0dGVDbGllbnQgfSBmcm9tICdtb3VsaW5ldHRlLWNsaWVudCc7XG5pbXBvcnQgeyBNb3VsaW5ldHRlQnJvd3NlciwgTW91bGluZXR0ZUJyb3dzZXJGaWx0ZXJzIH0gZnJvbSAnbW91bGluZXR0ZS1icm93c2VyJztcbmltcG9ydCB7IE1vdWxpbmV0dGVQcm9ncmVzcyB9IGZyb20gJ21vdWxpbmV0dGUtcHJvZ3Jlc3MnO1xuXG5cbmludGVyZmFjZSBNb3VsaW5ldHRlU2V0dGluZ3Mge1xuXHRzZXNzaW9uSUQ6IHN0cmluZztcblx0ZG93bmxvYWRGb2xkZXI6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTW91bGluZXR0ZVNldHRpbmdzID0ge1xuXHRzZXNzaW9uSUQ6ICcnLFxuXHRkb3dubG9hZEZvbGRlcjogJ21vdWxpbmV0dGUnXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vdWxpbmV0dGVQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXG5cdHN0YXRpYyBDQUNIRV9USU1FT1VUID0gMTAwMCAqIDYwICogNjAgKiAyMyBcdFx0Ly8gY2FjaGUgbXVzdCBiZSByZWZyZXNoZWQgYmVmb3JlIDI0IGhvdXJzXG5cblx0c2V0dGluZ3M6IE1vdWxpbmV0dGVTZXR0aW5ncztcblx0Y3JlYXRvcnM6IE1vdWxpbmV0dGVDcmVhdG9yW107XHQgICAgICAgIC8vIGFzc2V0IGxpc3QgKGluIGNhY2hlKVxuXHRjcmVhdG9yc0RhdGU6IG51bWJlcjsgICAgICAgICAgICAgICAgICAgLy8gZGF0ZSB3aGVuIGFzc2V0cyBoYXZlIGJlZW4gZG93bmxvYWRlZFxuXHRsYXN0RmlsdGVyczogTW91bGluZXR0ZUJyb3dzZXJGaWx0ZXJzOyAgLy8gbGFzdC11c2VkIGZpbHRlcnNcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblx0XHR0aGlzLmxhc3RGaWx0ZXJzID0gbmV3IE1vdWxpbmV0dGVCcm93c2VyRmlsdGVycygpXG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oJ2NyZWF0ZScsIGFzeW5jIChmaWxlKSA9PiB7XG5cdFx0XHR0aGlzLmRvd25sb2FkUGFnZShmaWxlKVxuXHRcdH0pKTtcblxuXHRcdE1vdWxpbmV0dGVVdGlscy5QUkVGSVggPSB0aGlzLnNldHRpbmdzLmRvd25sb2FkRm9sZGVyICsgXCIvXCJcblxuXHRcdC8vIFRoaXMgY3JlYXRlcyBhbiBpY29uIGluIHRoZSBsZWZ0IHJpYmJvbi5cblx0XHR0aGlzLmFkZFJpYmJvbkljb24oJ2hhbW1lcicsICdNb3VsaW5ldHRlIEJyb3dzZXInLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHR0aGlzLmdldENyZWF0b3JzKCkudGhlbigoY3JlYXRvcnMpID0+IG5ldyBNb3VsaW5ldHRlQnJvd3Nlcih0aGlzLCBjcmVhdG9ycywgdGhpcy5sYXN0RmlsdGVycykub3BlbigpKVxuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnYnJvd3NlcicsXG5cdFx0XHRuYW1lOiAnT3BlbiBNb3VsaW5ldHRlIEJyb3dzZXInLFxuXHRcdFx0Ly9ob3RrZXlzOiBbeyBrZXk6ICdNJywgbW9kaWZpZXJzOiBbJ0N0cmwnLCAnU2hpZnQnXSB9XSxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZ2V0Q3JlYXRvcnMoKS50aGVuKChjcmVhdG9ycykgPT4gbmV3IE1vdWxpbmV0dGVCcm93c2VyKHRoaXMsIGNyZWF0b3JzLCB0aGlzLmxhc3RGaWx0ZXJzKS5vcGVuKCkpXG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdjbGVhci1jYWNoZScsXG5cdFx0XHRuYW1lOiAnQ2xlYXIgY2FjaGUnLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0dGhpcy5jbGVhckNhY2hlKClcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ3JlbG9hZC1wYWdlJyxcblx0XHRcdG5hbWU6ICdSZS1kb3dubG9hZCBwYWdlJyxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGN1clZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG5cdFx0XHRcdGlmIChjdXJWaWV3ICYmIGN1clZpZXcuZmlsZSkge1xuXHRcdFx0XHRcdGNvbnN0IGxhc3RsaW5lID0gY3VyVmlldy5lZGl0b3IubGFzdExpbmUoKTtcblx0XHRcdFx0XHRjb25zdCBsYXN0Q2ggPSBjdXJWaWV3LmVkaXRvci5nZXRMaW5lKGxhc3RsaW5lKS5sZW5ndGg7XG5cdFx0XHRcdFx0Y3VyVmlldy5lZGl0b3Iuc2V0U2VsZWN0aW9uKHsgbGluZTogMCwgY2g6IDAgfSwgeyBsaW5lOiBsYXN0bGluZSwgY2g6IGxhc3RDaCB9KTtcblx0XHRcdFx0XHR0aGlzLmRvd25sb2FkUGFnZShjdXJWaWV3LmZpbGUpXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ3NlYXJjaCcsXG5cdFx0XHRuYW1lOiAnT3BlbiBRdWljayBTZWFyY2gnLFxuXHRcdFx0Ly9ob3RrZXlzOiBbeyBrZXk6ICdNJywgbW9kaWZpZXJzOiBbJ0N0cmwnXSB9XSxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZ2V0Q3JlYXRvcnMoKS50aGVuKChjcmVhdG9ycykgPT4gbmV3IE1vdWxpbmV0dGVTZWFyY2hNb2RhbCh0aGlzLCBjcmVhdG9ycykub3BlbigpKVxuXHRcdFx0fSxcblx0XHR9KTtcblxuXHRcdC8vIFRoaXMgYWRkcyBhIHNldHRpbmdzIHRhYiBzbyB0aGUgdXNlciBjYW4gY29uZmlndXJlIHZhcmlvdXMgYXNwZWN0cyBvZiB0aGUgcGx1Z2luXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNb3VsaW5ldHRlU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0Ly8gU3VwcG9ydCBsb2NhbCBwYXRocyBpbiA8aW1nPlxuXHRcdC8vIEluc3BpcmVkIGJ5IDogaHR0cHM6Ly9naXRodWIuY29tL3RhbGVuZ3Uvb2JzaWRpYW4tbG9jYWwtaW1nLXBsdWdpbi9ibG9iL21hc3Rlci9tYWluLnRzXG5cdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duUG9zdFByb2Nlc3NvcigoZWxlbWVudCwgY3R4KSA9PiB7XG5cdFx0XHRjb25zdCB0YXJnZXRMaW5rcyA9IEFycmF5LmZyb20oZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImltZ1wiKSlcblx0XHRcdGZvciAoY29uc3QgbGluayBvZiB0YXJnZXRMaW5rcykge1xuXHRcdFx0XHRsZXQgY2xlYW5fbGluayA9IGxpbmsuc3JjLnJlcGxhY2UoJ2FwcDovL29ic2lkaWFuLm1kLycsICcnKS5yZXBsYWNlKCdjYXBhY2l0b3I6Ly9sb2NhbGhvc3QvJywgJycpXG5cdFx0XHRcdGxldCBmdWxsX2xpbmsgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmdldFJlc291cmNlUGF0aChjbGVhbl9saW5rKVxuXHRcdFx0XHRsaW5rLnNyYyA9IGZ1bGxfbGlua1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cdFx0dGhpcy5jbGVhckNhY2hlKClcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEByZXR1cm5zIGxpc3Qgb2YgYXNzZXRzXG5cdCAqL1xuXHRhc3luYyBnZXRDcmVhdG9ycygpIHtcblx0XHRjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG5cdFx0aWYgKHRoaXMuY3JlYXRvcnMgJiYgKHN0YXJ0IC0gdGhpcy5jcmVhdG9yc0RhdGUgPCBNb3VsaW5ldHRlUGx1Z2luLkNBQ0hFX1RJTUVPVVQpKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdG9yc1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBwcm9ncmVzcyA9IG5ldyBNb3VsaW5ldHRlUHJvZ3Jlc3ModGhpcy5hcHApXG5cdFx0XHRwcm9ncmVzcy5vcGVuKClcblx0XHRcdHRoaXMuY3JlYXRvcnMgPSBhd2FpdCBNb3VsaW5ldHRlQ2xpZW50LmdldFVzZXJBc3NldHModGhpcy5zZXR0aW5ncy5zZXNzaW9uSUQpXG5cdFx0XHRwcm9ncmVzcy5jbG9zZSgpXG5cdFx0XHR0aGlzLmNyZWF0b3JzRGF0ZSA9IHN0YXJ0XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdG9yc1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBjbGVhciBhbGwgY2FjaGVzXG5cdCAqL1xuXHRjbGVhckNhY2hlKCkge1xuXHRcdHRoaXMuY3JlYXRvcnMgPSBbXVxuXHRcdHRoaXMuY3JlYXRvcnNEYXRlID0gMFxuXHRcdG5ldyBOb3RpY2UoJ01vdWxpbmV0dGUgQ2FjaGUgY2xlYXJlZCEnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBkb3dubG9hZCBmaWxlIGZyb20gc2VydmVyIChpZiBleGlzdHMpXG5cdCAqL1xuXHRhc3luYyBkb3dubG9hZFBhZ2UoZmlsZTogVEFic3RyYWN0RmlsZSkge1xuXHRcdGlmIChmaWxlLm5hbWUuZW5kc1dpdGgoXCIubWRcIikgJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoTW91bGluZXR0ZVV0aWxzLlBSRUZJWCkpIHtcblx0XHRcdGNvbnN0IHBhY2tJZCA9IGZpbGUucGF0aC5zcGxpdChcIi9cIilbMV1cblx0XHRcdC8vIGxvb2sgZm9yIGEgbWF0Y2hpbmcgcGFja1xuXHRcdFx0Y29uc3QgY3JlYXRvcnMgPSBhd2FpdCB0aGlzLmdldENyZWF0b3JzKClcblx0XHRcdGZvciAoY29uc3QgYyBvZiBjcmVhdG9ycykge1xuXHRcdFx0XHRjb25zdCBwYWNrID0gYy5wYWNrcy5maW5kKHAgPT4gcC5wYWNrSWQgPT0gcGFja0lkKVxuXHRcdFx0XHRjb25zdCBmaWxlcGF0aCA9IGZpbGUucGF0aC5yZXBsYWNlKE1vdWxpbmV0dGVVdGlscy5QUkVGSVgsIFwiXCIpXG5cdFx0XHRcdGlmIChwYWNrKSB7XG5cdFx0XHRcdFx0Y29uc3QgYSA9IHBhY2suYXNzZXRzLmZpbmQoKGEpID0+IGEucGF0aCA9PSBmaWxlcGF0aClcblx0XHRcdFx0XHRpZiAoYSkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgc2Vzc2lvbklkID0gdGhpcy5zZXR0aW5ncy5zZXNzaW9uSUQgPyB0aGlzLnNldHRpbmdzLnNlc3Npb25JRCA6IFwiZGVtby11c2VyXCJcblx0XHRcdFx0XHRcdGNvbnN0IHVybCA9IGAvYXNzZXRzL2Rvd25sb2FkLWFzc2V0LyR7c2Vzc2lvbklkfS8ke3BhY2suaWR9P2ZpbGU9JHthLnBhdGh9Jm1zPSR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YFxuXHRcdFx0XHRcdFx0TW91bGluZXR0ZVV0aWxzLmRvd25sb2FkTWFya2Rvd24odGhpcywgdXJsKS50aGVuKChtZFRleHQpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRcdFx0XHRcdC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBlZGl0aW5nIGEgTWFya2Rvd24gZmlsZS5cblx0XHRcdFx0XHRcdFx0aWYgKG1kVGV4dCAmJiB2aWV3KSB7XG5cdFx0XHRcdFx0XHRcdFx0dmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihtZFRleHQpXG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBObyBNb3VsaW5ldHRlIG1hdGNoIGZvdW5kIGZvciAke2ZpbGUubmFtZX0hYCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cbn1cbiIsICIvLyBAdHMtbm9jaGVja1xuXG4vKipcbiAqIE1vdWxpbmV0dGUgYXNzZXRcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIE1vdWxpbmV0dGVBc3NldCB7XG4gIHBhdGg6IHN0cmluZ1xuXG4gIHN0YXRpYyBUWVBFX05PTkUgID0gMFxuICBzdGF0aWMgVFlQRV9JTUFHRSA9IDFcbiAgc3RhdGljIFRZUEVfQVVESU8gPSAyXG4gIHN0YXRpYyBUWVBFX1RFWFQgID0gM1xuXG4gIGNvbnN0cnVjdG9yKHBhdGgpIHtcbiAgICB0aGlzLnBhdGggPSBwYXRoXG4gIH1cblxuICBnZXRVcmwocGFjazogTW91bGluZXR0ZVBhY2spOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtwYWNrLnBhdGh9LyR7dGhpcy5wYXRofT8ke3BhY2suc2FzID8gcGFjay5zYXMgOiBcIlwifWBcbiAgfVxuXG4gIGdldFR5cGUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTW91bGluZXR0ZUFzc2V0LlRZUEVfTk9ORVxuICB9XG5cbiAgc3RhdGljIGZyb21EaWN0KG9iajogb2JqZWN0KTogTW91bGluZXR0ZUFzc2V0IHtcbiAgICBjb25zdCBhc3NldCA9IG5ldyBNb3VsaW5ldHRlQXNzZXQoKVxuICAgIGlmKHR5cGVvZiBvYmogPT09IFwic3RyaW5nXCIgfHwgb2JqIGluc3RhbmNlb2YgU3RyaW5nKSB7XG4gICAgICBhc3NldC5wYXRoID0gb2JqLnRvU3RyaW5nKClcbiAgICAgIGNvbnN0IGV4dCA9IGFzc2V0LnBhdGguc3BsaXQoXCIuXCIpLnBvcCgpXG4gICAgICBpZihbXCJ3ZWJwXCJdLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNb3VsaW5ldHRlSW1hZ2UoYXNzZXQucGF0aClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoW1wib2dnXCIsIFwibXAzXCJdLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNb3VsaW5ldHRlU291bmQoYXNzZXQucGF0aClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoW1wibWRcIl0uaW5jbHVkZXMoZXh0KSkge1xuICAgICAgICByZXR1cm4gbmV3IE1vdWxpbmV0dGVUZXh0KGFzc2V0LnBhdGgpXG4gICAgICB9XG4gICAgfSBcbiAgICAvLyBjb21wbGV4IHR5cGVcbiAgICBlbHNlIGlmKFtcInNuZFwiLCBcIm1kXCJdLmluY2x1ZGVzKG9iai50eXBlKSAmJiBvYmoucGF0aCkge1xuICAgICAgc3dpdGNoKG9iai50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJzbmRcIjpcbiAgICAgICAgICBjb25zdCBzb3VuZCA9IG5ldyBNb3VsaW5ldHRlU291bmQob2JqLnBhdGgpXG4gICAgICAgICAgc291bmQuZHVyYXRpb24gPSBvYmouZHVyYXRpb25cbiAgICAgICAgICByZXR1cm4gc291bmRcbiAgICAgICAgY2FzZSBcIm1kXCI6XG4gICAgICAgICAgY29uc3QgbWFya2Rvd24gPSBuZXcgTW91bGluZXR0ZVRleHQob2JqLnBhdGgpXG4gICAgICAgICAgaWYob2JqLm1ldGEgJiYgb2JqLm1ldGEuZGVzY3JpcHRpb24pIG1hcmtkb3duLmRlc2NyaXB0aW9uID0gb2JqLm1ldGEuZGVzY3JpcHRpb25cbiAgICAgICAgICBpZihvYmoubWV0YSAmJiBvYmoubWV0YS50eXBlKSBtYXJrZG93bi50eXBlID0gb2JqLm1ldGEudHlwZVxuICAgICAgICAgIGlmKG9iai5tZXRhICYmIG9iai5tZXRhLnN1YnR5cGUpIG1hcmtkb3duLnN1YnR5cGUgPSBvYmoubWV0YS5zdWJ0eXBlXG4gICAgICAgICAgcmV0dXJuIG1hcmtkb3duXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vdWxpbmV0dGVJbWFnZSBleHRlbmRzIE1vdWxpbmV0dGVBc3NldCB7XG4gIGdldFR5cGUoKTogbnVtYmVyIHsgcmV0dXJuIE1vdWxpbmV0dGVBc3NldC5UWVBFX0lNQUdFIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vdWxpbmV0dGVTb3VuZCBleHRlbmRzIE1vdWxpbmV0dGVBc3NldCB7XG4gIGR1cmF0aW9uOiBudW1iZXJcbiAgZ2V0VHlwZSgpOiBudW1iZXIgeyByZXR1cm4gTW91bGluZXR0ZUFzc2V0LlRZUEVfQVVESU8gfVxufVxuXG5leHBvcnQgY2xhc3MgTW91bGluZXR0ZVRleHQgZXh0ZW5kcyBNb3VsaW5ldHRlQXNzZXQge1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gIHR5cGU6IHN0cmluZ1xuICBzdWJ0eXBlOiBzdHJpbmdcbiAgXG4gIGdldFR5cGUoKTogbnVtYmVyIHsgcmV0dXJuIE1vdWxpbmV0dGVBc3NldC5UWVBFX1RFWFQgfVxuICBnZXRVcmwocGFjazogTW91bGluZXR0ZVBhY2spOiBzdHJpbmcge1xuICAgIHJldHVybiBgL2Fzc2V0cy9kb3dubG9hZC1hc3NldC9TRVNTSU9OSUQvJHtwYWNrLmlkfT9maWxlPSR7dGhpcy5wYXRofSZtcz0ke25ldyBEYXRlKCkuZ2V0VGltZSgpfWBcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTW91bGluZXR0ZVBhY2sge1xuICBpZDogbnVtYmVyXG4gIG5hbWU6IHN0cmluZ1xuICBwYXRoOiBzdHJpbmdcbiAgc2FzOiBzdHJpbmdcbiAgcGFja0lkOiBzdHJpbmdcbiAgYXNzZXRzOiBNb3VsaW5ldHRlQXNzZXRbXVxuXG4gIHN0YXRpYyBmcm9tRGljdChvYmo6IG9iamVjdCk6IE1vdWxpbmV0dGVQYWNrIHtcbiAgICBjb25zdCBwYWNrID0gbmV3IE1vdWxpbmV0dGVQYWNrKClcbiAgICBpZihvYmouaWQpIHtcbiAgICAgIHBhY2suaWQgPSBvYmouaWRcbiAgICB9XG4gICAgaWYob2JqLm5hbWUpIHtcbiAgICAgIHBhY2submFtZSA9IG9iai5uYW1lXG4gICAgfVxuICAgIGlmKG9iai5wYXRoKSB7XG4gICAgICBwYWNrLnBhdGggPSBvYmoucGF0aFxuICAgICAgaWYob2JqLnBhdGguZW5kc1dpdGgoXCIuZ2l0XCIpKSB7XG4gICAgICAgIHBhY2sucGFja0lkID0gb2JqLnBhdGguc3BsaXQoJy8nKS5wb3AoKS5zbGljZSgwLCAtNCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmKG9iai5zYXMpIHtcbiAgICAgIHBhY2suc2FzID0gb2JqLnNhc1xuICAgIH1cbiAgICBpZihvYmouYXNzZXRzKSB7XG4gICAgICBwYWNrLmFzc2V0cyA9IFtdXG4gICAgICBmb3IoY29uc3QgYSBvZiBvYmouYXNzZXRzKSB7XG4gICAgICAgIGNvbnN0IGFzc2V0ID0gTW91bGluZXR0ZUFzc2V0LmZyb21EaWN0KGEpXG4gICAgICAgIGlmKGFzc2V0KSB7XG4gICAgICAgICAgcGFjay5hc3NldHMucHVzaChhc3NldClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcGFja1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBNb3VsaW5ldHRlQ3JlYXRvciB7XG4gIG5hbWU6IHN0cmluZ1xuICBwYWNrczogTW91bGluZXR0ZVBhY2tbXVxuXG4gIHN0YXRpYyBmcm9tRGljdChvYmo6IG9iamVjdCk6IE1vdWxpbmV0dGVDcmVhdG9yIHtcbiAgICBjb25zdCBjcmVhdG9yID0gbmV3IE1vdWxpbmV0dGVDcmVhdG9yKClcbiAgICBpZihvYmoucHVibGlzaGVyKSB7XG4gICAgICBjcmVhdG9yLm5hbWUgPSBvYmoucHVibGlzaGVyXG4gICAgfVxuICAgIGlmKG9iai5wYWNrcykge1xuICAgICAgY3JlYXRvci5wYWNrcyA9IFtdXG4gICAgICBmb3IoY29uc3QgcCBvZiBvYmoucGFja3MpIHtcbiAgICAgICAgY29uc3QgcGFjayA9IE1vdWxpbmV0dGVQYWNrLmZyb21EaWN0KHApXG4gICAgICAgIGlmKHBhY2suYXNzZXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjcmVhdG9yLnBhY2tzLnB1c2gocGFjaylcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY3JlYXRvclxuICB9XG5cbiAgc3RhdGljIGltcG9ydENyZWF0b3JzKG9iajogb2JqZWN0KTogTW91bGluZXR0ZUNyZWF0b3JbXSB7XG4gICAgaWYoIW9iaikgcmV0dXJuIFtdXG4gICAgY29uc3QgY3JlYXRvcnMgPSBbXVxuICAgIGZvcihjb25zdCBjIG9mIG9iaikge1xuICAgICAgY29uc3QgY3JlYXRvciA9IE1vdWxpbmV0dGVDcmVhdG9yLmZyb21EaWN0KGMpXG4gICAgICBpZihjcmVhdG9yLnBhY2tzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY3JlYXRvcnMucHVzaChjcmVhdG9yKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY3JlYXRvcnNcbiAgfVxufSIsICJpbXBvcnQgeyBNb3VsaW5ldHRlQ3JlYXRvciB9IGZyb20gXCJtb3VsaW5ldHRlLWVudGl0aWVzXCI7XG5pbXBvcnQgeyByZXF1ZXN0VXJsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbi8qKlxuICogQ2xpZW50IGZvciBNb3VsaW5ldHRlIHNlcnZlclxuICovXG5leHBvcnQgY2xhc3MgTW91bGluZXR0ZUNsaWVudCB7XG4gIFxuICBzdGF0aWMgU0VSVkVSX1VSTCA9IFwiaHR0cHM6Ly9hc3NldHMubW91bGluZXR0ZS5jbG91ZFwiXG4gIC8vc3RhdGljIFNFUlZFUl9VUkwgPSBcImh0dHA6Ly8xMjcuMC4wLjE6NTAwMFwiXG4gIHN0YXRpYyBIRUFERVJTID0geyAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cbiAgc3RhdGljIENMSUVOVF9JRCA9IFwiSzNvZmNMOFh5YU9iUnJPXzVWUHV6WEVQbk9WQ0lXM2ZiTEl0NlZ5Z3RfWUlNNklLeEE0MDRaUTBwWmJaMFZrQlwiXG4gIHN0YXRpYyBSRU1PVEVfQkFTRSA9IFwiaHR0cHM6Ly9tdHRlY2xvdWRzdG9yYWdlLmJsb2IuY29yZS53aW5kb3dzLm5ldFwiXG4gIFxuICAvKlxuICAgKiBTZW5kcyBhIHJlcXVlc3QgdG8gc2VydmVyIGFuZCByZXR1cm5zIHRoZSByZXNwb25zZVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHJlcXVlc3RTZXJ2ZXIoVVJJOiBzdHJpbmcsIG1ldGhvZDogc3RyaW5nLCBkYXRhOiBvYmplY3QgfCBudWxsKSB7XG4gICAgbGV0IHBhcmFtcyA9IHsgdXJsOiBgJHtNb3VsaW5ldHRlQ2xpZW50LlNFUlZFUl9VUkx9JHtVUkl9YCwgbWV0aG9kLCBoZWFkZXJzOiBNb3VsaW5ldHRlQ2xpZW50LkhFQURFUlMsIGJvZHk6IGRhdGEgPyBKU09OLnN0cmluZ2lmeShkYXRhKSA6IHVuZGVmaW5lZCB9XG4gXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHBhcmFtcykuY2F0Y2goZnVuY3Rpb24oZSkge1xuICAgICAgY29uc29sZS5lcnJvcihgTW91bGluZXR0ZUNsaWVudCB8IENhbm5vdCBlc3RhYmxpc2ggY29ubmVjdGlvbiB0byBzZXJ2ZXIgJHtNb3VsaW5ldHRlQ2xpZW50LlNFUlZFUl9VUkx9YCwgZSlcbiAgICAgIHJldHVybiBudWxsXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cbiAgXG4gIC8qXG4gICAqIFNlbmRzIGEgcmVxdWVzdCB0byBzZXJ2ZXIgYW5kIHJldHVybiB0aGUgcmVzcG9uc2Ugb3IgbnVsbCAoaWYgc2VydmVyIHVucmVhY2hhYmxlKVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHNlbmQoVVJJOiBzdHJpbmcsIG1ldGhvZDogc3RyaW5nLCBkYXRhOiBvYmplY3QgfCBudWxsKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3RTZXJ2ZXIoVVJJLCBtZXRob2QsIGRhdGEpXG4gICAgaWYoIXJlc3BvbnNlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHsgJ3N0YXR1cyc6IHJlc3BvbnNlLnN0YXR1cywgJ2RhdGEnOiBhd2FpdCByZXNwb25zZS5qc29uIH1cbiAgfVxuICBcbiAgc3RhdGljIGFzeW5jIGdldChVUkk6IHN0cmluZykgeyByZXR1cm4gTW91bGluZXR0ZUNsaWVudC5zZW5kKFVSSSwgXCJHRVRcIiwgbnVsbCkgfVxuICBzdGF0aWMgYXN5bmMgcG9zdChVUkk6IHN0cmluZywgZGF0YTogb2JqZWN0KSB7IHJldHVybiB0aGlzLnNlbmQoVVJJLCBcIlBPU1RcIiwgZGF0YSkgfVxuXG5cbiAgLyoqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbiAgXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgdXNlciBkZXRhaWxzIChuYW1lLCB0aWVycywgZXRjLilcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRVc2VyKHVzZXJJZDogc3RyaW5nLCBmb3JjZVJlZnJlc2ggPSBmYWxzZSkge1xuICAgIGNvbnN0IG5vQ2FjaGUgPSBcIj9tcz1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgY29uc3QgcmVmcmVzaCA9IGZvcmNlUmVmcmVzaCA/IFwiZm9yY2U9MVwiIDogXCJcIlxuICAgIHJldHVybiBhd2FpdCBNb3VsaW5ldHRlQ2xpZW50LmdldChgL3VzZXIvJHt1c2VySWR9JHtub0NhY2hlfSYke3JlZnJlc2h9YClcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgdXNlciBhc3NldHMgKGltYWdlcywgbWFya2Rvd25zLCBldGMuKVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGdldFVzZXJBc3NldHModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPE1vdWxpbmV0dGVDcmVhdG9yW10+IHtcbiAgICB1c2VySWQgPSB1c2VySWQgJiYgdXNlcklkLmxlbmd0aCA9PSAyNiA/IHVzZXJJZCA6IFwiZGVtb3VzZXJcIlxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IE1vdWxpbmV0dGVDbGllbnQuZ2V0KGAvYXNzZXRzLyR7dXNlcklkfT9jbGllbnQ9b2JzaWRpYW4mbXM9JHtuZXcgRGF0ZSgpLmdldFRpbWUoKX1gKVxuICAgIGlmKHJlc3VsdCAmJiByZXN1bHQuc3RhdHVzID09IDIwMCkge1xuICAgICAgcmV0dXJuIE1vdWxpbmV0dGVDcmVhdG9yLmltcG9ydENyZWF0b3JzKHJlc3VsdC5kYXRhKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cbn1cblxuIiwgImltcG9ydCBNb3VsaW5ldHRlUGx1Z2luIGZyb20gJ21haW4nO1xuaW1wb3J0IHsgTW91bGluZXR0ZUNsaWVudCB9IGZyb20gJ21vdWxpbmV0dGUtY2xpZW50JztcbmltcG9ydCB7IE1vdWxpbmV0dGVDcmVhdG9yLCBNb3VsaW5ldHRlUGFjayB9IGZyb20gJ21vdWxpbmV0dGUtZW50aXRpZXMnO1xuaW1wb3J0IHsgVmF1bHQsIG5vcm1hbGl6ZVBhdGgsIHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XG5cbi8qKlxuICogTW91bGluZXR0ZSBhc3NldFxuICovXG5leHBvcnQgY2xhc3MgTW91bGluZXR0ZVV0aWxzIHtcbiAgXG4gIHN0YXRpYyBQUkVGSVggPSBcIm1vdWxpbmV0dGUvXCJcblxuICAvLyBodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zLzQvNDgvTWFya2Rvd24tbWFyay5zdmdcbiAgLy8gaHR0cHM6Ly95b2tzZWwuZ2l0aHViLmlvL3VybC1lbmNvZGVyL1xuICAvL3N0YXRpYyBJTUFHRV9JQ09OID0gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgNTEyIDUxMlwiPjwhLS0hRm9udCBBd2Vzb21lIEZyZWUgNi41LjEgYnkgQGZvbnRhd2Vzb21lIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20gTGljZW5zZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tL2xpY2Vuc2UvZnJlZSBDb3B5cmlnaHQgMjAyNCBGb250aWNvbnMsIEluYy4tLT48cGF0aCBmaWxsPVwiJTIzRkZGXCIgZD1cIk00NDggODBjOC44IDAgMTYgNy4yIDE2IDE2VjQxNS44bC01LTYuNS0xMzYtMTc2Yy00LjUtNS45LTExLjYtOS4zLTE5LTkuM3MtMTQuNCAzLjQtMTkgOS4zTDIwMiAzNDAuN2wtMzAuNS00Mi43QzE2NyAyOTEuNyAxNTkuOCAyODggMTUyIDI4OHMtMTUgMy43LTE5LjUgMTAuMWwtODAgMTEyTDQ4IDQxNi4zbDAtLjNWOTZjMC04LjggNy4yLTE2IDE2LTE2SDQ0OHpNNjQgMzJDMjguNyAzMiAwIDYwLjcgMCA5NlY0MTZjMCAzNS4zIDI4LjcgNjQgNjQgNjRINDQ4YzM1LjMgMCA2NC0yOC43IDY0LTY0Vjk2YzAtMzUuMy0yOC43LTY0LTY0LTY0SDY0em04MCAxOTJhNDggNDggMCAxIDAgMC05NiA0OCA0OCAwIDEgMCAwIDk2elwiLz48L3N2Zz5gXG4gIC8vc3RhdGljIFRFWFRfSUNPTiA9IGBkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCw8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjIwOFwiIGhlaWdodD1cIjEyOFwiIHZpZXdCb3g9XCIwIDAgMjA4IDEyOFwiPjxyZWN0IHdpZHRoPVwiMTk4XCIgaGVpZ2h0PVwiMTE4XCIgeD1cIjVcIiB5PVwiNVwiIHJ5PVwiMTBcIiBzdHJva2U9XCIlMjNGRkZcIiBzdHJva2Utd2lkdGg9XCIxMFwiIGZpbGw9XCIlMjNGRkZcIi8+PHBhdGggZD1cIk0zMCA5OFYzMGgyMGwyMCAyNSAyMC0yNWgyMHY2OEg5MFY1OUw3MCA4NCA1MCA1OXYzOXptMTI1IDBsLTMwLTMzaDIwVjMwaDIwdjM1aDIwelwiLz48L3N2Zz5gXG4gIC8vc3RhdGljIEFVRElPX0lDT04gPSBgZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgsPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCI1MDBcIiBoZWlnaHQ9XCI1MDBcIiB2aWV3Qm94PVwiMCAwIDc1IDc1XCI+PHBhdGggZD1cIk0zOS4zODksMTMuNzY5IEwyMi4yMzUsMjguNjA2IEw2LDI4LjYwNiBMNiw0Ny42OTkgTDIxLjk4OSw0Ny42OTkgTDM5LjM4OSw2Mi43NSBMMzkuMzg5LDEzLjc2OXpcIiBzdHlsZT1cInN0cm9rZTolMjNGRkY7c3Ryb2tlLXdpZHRoOjU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO2ZpbGw6JTIzRkZGO1wiLz48cGF0aCBkPVwiTTQ4LDI3LjZhMTkuNSwxOS41IDAgMCAxIDAsMjEuNE01NS4xLDIwLjVhMzAsMzAgMCAwIDEgMCwzNS42TTYxLjYsMTRhMzguOCwzOC44IDAgMCAxIDAsNDguNlwiIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZTolMjNGRkY7c3Ryb2tlLXdpZHRoOjU7c3Ryb2tlLWxpbmVjYXA6cm91bmRcIi8+PC9zdmc+YFxuICBcbiAgLyoqXG4gICAqIEltcHJvdmVzIG5hbWUgKG9yaWdpbmFsbHkgYSBmaWxlcGF0aCkgYnkgcmVwbGFjaW5nIHNlcGFyYXRvcnNcbiAgICovXG4gIHN0YXRpYyBiZWF1dGlmeU5hbWUobmFtZTogc3RyaW5nKSB7XG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW18tXS9nLCAnICcpXG4gICAgbmFtZSA9IG5hbWUuaW5kZXhPZihcIi5cIikgPiAwID8gbmFtZS5zdWJzdHJpbmcoMCwgbmFtZS5pbmRleE9mKFwiLlwiKSkgOiBuYW1lIC8vIHJlbW92ZXIgZmlsZSBleHRlbnNpb24gKGlmIGFueSlcbiAgICAvLyB1cHBlcmNhc2UgZmlyc3QgbGV0dGVyIG9mIGVhY2ggd29yZFxuICAgIG5hbWUgPSBuYW1lLnNwbGl0KFwiIFwiKS5tYXAoKHdvcmQpID0+IHsgXG4gICAgICByZXR1cm4gd29yZC5sZW5ndGggPCAyID8gd29yZCA6IHdvcmRbMF0udG9VcHBlckNhc2UoKSArIHdvcmQuc3Vic3RyaW5nKDEpOyBcbiAgICB9KS5qb2luKFwiIFwiKTtcbiAgICByZXR1cm4gbmFtZVxuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgdXRpbGl0eSBmdW5jdGlvbiBkb3dubG9hZHMgYSByZW1vdGUgaW1hZ2UgKGZyb20gTW91bGluZXR0ZSBDbG91ZClcbiAgICogSW50byBhIHNwZWNpZmljIGZvbGRlciAodW5kZXIgL21vdWxpbmV0dGUpXG4gICAqIFxuICAgKiBAcGFyYW0gdmF1bHQgY3VycmVudCBWYXVsdFxuICAgKiBAcGFyYW0gdXJsIGltYWdlIFVSTFxuICAgKiBAcmV0dXJucyBpbWFnZSBwYXRoIHdpdGhpbiB0aGUgdmF1bHRcbiAgICovXG4gIHN0YXRpYyBhc3luYyBkb3dubG9hZEZpbGUodmF1bHQ6IFZhdWx0LCB1cmw6IHN0cmluZykge1xuICAgIFxuICAgIGxldCBpbWFnZVBhdGggPSB1cmxcblxuICAgIC8vIFVSTCBmb3IgQXp1cmVcbiAgICBpZih1cmwuc3RhcnRzV2l0aChNb3VsaW5ldHRlQ2xpZW50LlJFTU9URV9CQVNFKSkge1xuICAgICAgaW1hZ2VQYXRoID0gTW91bGluZXR0ZVV0aWxzLlBSRUZJWCArIHVybC5zdWJzdHJpbmcoTW91bGluZXR0ZUNsaWVudC5SRU1PVEVfQkFTRS5sZW5ndGggKyAxLCB1cmwubGFzdEluZGV4T2YoXCI/XCIpKVxuICAgIH0gXG4gICAgLy8gVVJMIGZvciBtb3VsaW5ldHRlLmNsb3VkXG4gICAgZWxzZSBpZih1cmwuc3RhcnRzV2l0aChNb3VsaW5ldHRlQ2xpZW50LlNFUlZFUl9VUkwpKSB7XG4gICAgICBjb25zdCBpZHggPSB1cmwubGFzdEluZGV4T2YoXCI/ZmlsZT1cIilcbiAgICAgIGlmKGlkeCA+IDApIHtcbiAgICAgICAgaW1hZ2VQYXRoID0gTW91bGluZXR0ZVV0aWxzLlBSRUZJWCArIHVybC5zcGxpdChcIj9maWxlPVwiKVsxXVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBJbnZhbGlkIFVSTDogJHt1cmx9YClcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJQYXRoID0gaW1hZ2VQYXRoLnN1YnN0cmluZygwLCBpbWFnZVBhdGgubGFzdEluZGV4T2YoXCIvXCIpKSAgXG5cbiAgICAvLyBjcmVhdGUgZm9sZGVyIHN0cnVjdHVyZVxuICAgIGlmKCEoYXdhaXQgdmF1bHQuYWRhcHRlci5leGlzdHMobm9ybWFsaXplUGF0aChmb2xkZXJQYXRoKSkpKSB7XG4gICAgICB2YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aClcbiAgICB9XG4gICAgXG4gICAgLy8gZG93bmxvYWQgZmlsZVxuICAgIGlmKCEoYXdhaXQgdmF1bHQuYWRhcHRlci5leGlzdHMobm9ybWFsaXplUGF0aChpbWFnZVBhdGgpKSkpIHtcbiAgICAgIGF3YWl0IHJlcXVlc3RVcmwodXJsKVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPSAyMDApIHsgdGhyb3cgbmV3IEVycm9yKGBIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7cmVzcG9uc2UudGV4dH1gKSB9XG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmFycmF5QnVmZmVyO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihidWZmZXIgPT4ge1xuICAgICAgICAgIHZhdWx0LmNyZWF0ZUJpbmFyeShpbWFnZVBhdGgsIGJ1ZmZlcilcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIk1vdWxpbmV0dGUgfCBDb3VsZG4ndCBkb3dubG9hZCB0aGUgaW1hZ2UhXCIsIGVycilcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJNb3VsaW5ldHRlIHwgRmlsZSBhbHJlYWR5IGV4aXN0cy4gXCIsIGltYWdlUGF0aClcbiAgICB9XG5cbiAgICByZXR1cm4gaW1hZ2VQYXRoXG4gIH1cblxuICAvKipcbiAgICogVGhpcyB1dGlsaXR5IGZ1bmN0aW9uIGRvd25sb2FkcyBhIG1hcmtkb3duIGNvbnRlbnQgKGZyb20gTW91bGluZXR0ZSBDbG91ZClcbiAgICogXG4gICAqIEBwYXJhbSB2YXVsdCBjdXJyZW50IHZhdWx0XG4gICAqIEBwYXJhbSBjcmVhdG9ycyBjYWNoZWQgY3JlYXRvcnNcbiAgICogQHBhcmFtIHVybCBtYXJrZG93biBVUkxcbiAgICogQHJldHVybnMgbWFya2Rvd24gY29udGVudFxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGRvd25sb2FkTWFya2Rvd24ocGx1Z2luOiBNb3VsaW5ldHRlUGx1Z2luLCB1cmk6IHN0cmluZykge1xuICAgIGxldCBtYXJrZG93bkNvbnRlbnQgPSBcIlwiXG4gICAgY29uc3Qgc2Vzc2lvbklkID0gcGx1Z2luLnNldHRpbmdzLnNlc3Npb25JRCA/IHBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uSUQgOiBcImRlbW8tdXNlclwiXG4gICAgYXdhaXQgTW91bGluZXR0ZUNsaWVudC5yZXF1ZXN0U2VydmVyKHVyaS5yZXBsYWNlKFwiU0VTU0lPTklEXCIsIHNlc3Npb25JZCksIFwiZ2V0XCIsIG51bGwpXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2UpIHsgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkdXJpbmcgcmVxdWVzdGApIH1cbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPSAyMDApIHsgdGhyb3cgbmV3IEVycm9yKGBIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7cmVzcG9uc2UudGV4dH1gKSB9XG4gICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0O1xuICAgICAgfSlcbiAgICAgIC50aGVuKHRleHQgPT4ge1xuICAgICAgICBtYXJrZG93bkNvbnRlbnQgPSB0ZXh0XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJNb3VsaW5ldHRlIHwgQ291bGRuJ3QgZG93bmxvYWQgdGhlIG1hcmtkb3duIVwiLCBlcnIpXG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIGF3YWl0IE1vdWxpbmV0dGVVdGlscy5kb3dubG9hZERlcGVuZGVuY2llcyhwbHVnaW4sIG1hcmtkb3duQ29udGVudClcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgdGhlIGVudGlyZSBtYXJrZG93biBjb250ZW50IGZvciByZWZlcmVuY2VzICFbW3NvbWUgVVJMXV1cbiAgICogRG93bmxvYWQgdGhlIHJlZmVyZW5jZXMgaWYgZXhpc3Qgb24gTW91bGluZXR0ZVxuICAgKiBcbiAgICogQHBhcmFtIHZhdWx0IGN1cnJlbnQgdmF1bHRcbiAgICogQHBhcmFtIGNyZWF0b3JzICBjYWNoZWQgY3JlYXRvcnNcbiAgICogQHBhcmFtIG1hcmtkb3duIG1hcmtkb3duIGNvbnRlbnRcbiAgICovXG4gIHN0YXRpYyBhc3luYyBkb3dubG9hZERlcGVuZGVuY2llcyhwbHVnaW46IE1vdWxpbmV0dGVQbHVnaW4sIG1hcmtkb3duOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGxldCBuZXdNYXJrZG93biA9IG1hcmtkb3duXG4gICAgY29uc3QgbWF0Y2hlcyA9IG1hcmtkb3duLm1hdGNoQWxsKC8oXFwhPylcXFtcXFsoW15cXF1dKylcXF1cXF0vZylcbiAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHtcbiAgICAgIGNvbnN0IHJlZk1hcmsgPSBtYXRjaFsxXVxuICAgICAgbGV0IGFzc2V0UGF0aCA9IG1hdGNoWzJdXG5cbiAgICAgIGNvbnN0IGNyZWF0b3JzID0gYXdhaXQgcGx1Z2luLmdldENyZWF0b3JzKClcbiAgICAgIC8vIEEpIHJlZmVyZW5jZSBpcyBleHRlcm5hbCAoc3RhcnRzIHdpdGggbW91bGluZXR0ZS8pXG4gICAgICBpZihhc3NldFBhdGguc3RhcnRzV2l0aChNb3VsaW5ldHRlVXRpbHMuUFJFRklYKSkge1xuICAgICAgICBhc3NldFBhdGggPSBhc3NldFBhdGguc3Vic3RyaW5nKE1vdWxpbmV0dGVVdGlscy5QUkVGSVgubGVuZ3RoKVxuICAgICAgICBjb25zdCBjcmVhdG9yUGF0aCA9IGFzc2V0UGF0aC5zcGxpdChcIi9cIilbMF1cbiAgICAgICAgY29uc3QgcGFjayA9IGFzc2V0UGF0aC5zcGxpdChcIi9cIilbMV1cbiAgICAgICAgY29uc3QgYmFzZVVSTCA9IGAke2NyZWF0b3JQYXRofS8ke3BhY2t9YFxuICAgICAgICBmb3IoY29uc3QgYyBvZiBjcmVhdG9ycykge1xuICAgICAgICAgIGNvbnN0IHBhY2sgPSBjLnBhY2tzLmZpbmQocCA9PiBwLnBhdGguZW5kc1dpdGgoYmFzZVVSTCkpXG4gICAgICAgICAgaWYocGFjaykge1xuICAgICAgICAgICAgaWYocmVmTWFyayA9PSBcIiFcIikge1xuICAgICAgICAgICAgICAvLyBkb3dubG9hZCBhc3NldCAoZnJvbSBBenVyZSBTdG9yYWdlKVxuICAgICAgICAgICAgICBjb25zdCB1cmwgPSBgJHtwYWNrLnBhdGh9JHthc3NldFBhdGgucmVwbGFjZShiYXNlVVJMLCBcIlwiKX0/JHtwYWNrLnNhcyA/IHBhY2suc2FzIDogXCJcIn1gXG4gICAgICAgICAgICAgIGF3YWl0IE1vdWxpbmV0dGVVdGlscy5kb3dubG9hZEZpbGUocGx1Z2luLmFwcC52YXVsdCwgdXJsKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gQikgcmVmZXJlbmNlIGlzIHNwZWNpZmljIHRvIGEgTWFya2Rvd24gcGFjayAoc3RhcnRzIHdpdGggPG1vZHVsZS1pZD4vKVxuICAgICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHBhY2tJZCA9IGFzc2V0UGF0aC5zcGxpdChcIi9cIilbMF1cbiAgICAgICAgZm9yKGNvbnN0IGMgb2YgY3JlYXRvcnMpIHtcbiAgICAgICAgICBjb25zdCBwYWNrID0gYy5wYWNrcy5maW5kKHAgPT4gcC5wYWNrSWQgPT0gcGFja0lkKVxuICAgICAgICAgIGlmKHBhY2spIHtcbiAgICAgICAgICAgIGxldCBwYXRoID0gbnVsbFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBkb3dubG9hZCBlbWJlZGVkIGFzc2V0cyAoZnJvbSBHSVQpIFxuICAgICAgICAgICAgaWYocmVmTWFyayA9PSBcIiFcIikge1xuICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uSWQgPSBwbHVnaW4uc2V0dGluZ3Muc2Vzc2lvbklEID8gcGx1Z2luLnNldHRpbmdzLnNlc3Npb25JRCA6IFwiZGVtby11c2VyXCJcbiAgICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7TW91bGluZXR0ZUNsaWVudC5TRVJWRVJfVVJMfS9hc3NldHMvZG93bmxvYWQtYXNzZXQvJHtzZXNzaW9uSWR9LyR7cGFjay5pZH0/ZmlsZT0ke2Fzc2V0UGF0aH0mbXM9JHtuZXcgRGF0ZSgpLmdldFRpbWUoKX1gXG4gICAgICAgICAgICAgIHBhdGggPSBhd2FpdCBNb3VsaW5ldHRlVXRpbHMuZG93bmxvYWRGaWxlKHBsdWdpbi5hcHAudmF1bHQsIHVybClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGRvbid0IGRvd25sb2FkIHBhZ2VzIGF1dG9tYXRpY2FsbHkgKGFkZCBwcmVmaXggaW4gZnJvbSBvZiByZWZlcmVuY2UpXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgcGF0aCA9IE1vdWxpbmV0dGVVdGlscy5QUkVGSVggKyAoIGFzc2V0UGF0aC5zdGFydHNXaXRoKFwiL1wiKSA/IGFzc2V0UGF0aC5zdWJzdHJpbmcoMSkgOiBhc3NldFBhdGggKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihwYXRoKSB7XG4gICAgICAgICAgICAgIC8vIHJlcGxhY2UgcmVmZXJlbmNlc1xuICAgICAgICAgICAgICBuZXdNYXJrZG93biA9IG5ld01hcmtkb3duLnJlcGxhY2UobWF0Y2hbMF0sIGAke3JlZk1hcmt9W1ske3BhdGh9XV1gKVxuICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3TWFya2Rvd25cbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0cyBhIGR1cmF0aW9uIGludG8gYSBzdHJpbmcgcmVwcmVzZW50YXRpb25cbiAgICogQHBhcmFtIGR1cmF0aW9uIGR1cmF0aW9uIGFzIG51bWJlciBvZiBzZWNvbmRzXG4gICAqIEByZXR1cm5zIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZHVyYXRpb24gKDY1IHNlYyA9IDE6MDUpXG4gICAqL1xuICBzdGF0aWMgZm9ybWF0RHVyYXRpb24oZHVyYXRpb246IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgZHVySHIgPSBNYXRoLmZsb29yKGR1cmF0aW9uIC8gKDM2MDApKVxuICAgIGNvbnN0IGR1ck1pbiA9IE1hdGguZmxvb3IoKGR1cmF0aW9uIC0gMzYwMCpkdXJIcikvNjApXG4gICAgY29uc3QgZHVyU2VjID0gZHVyYXRpb24gJSA2MFxuICAgIHJldHVybiAoZHVySHIgPiAwID8gYCR7ZHVySHJ9OiR7ZHVyTWluLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwnMCcpfWAgOiBkdXJNaW4udG9TdHJpbmcoKSkgKyBcIjpcIiArIGR1clNlYy50b1N0cmluZygpLnBhZFN0YXJ0KDIsJzAnKVxuICB9XG5cbiAgLyoqXG4gICAqIE1lcmdlIHBhY2tzIHdpdGggc2FtZSBuYW1lXG4gICAqL1xuICBzdGF0aWMgY29tYmluZVBhY2tzKHBhY2tzOiBNb3VsaW5ldHRlUGFja1tdKTogeyBbaWQ6IHN0cmluZ10gOiBNb3VsaW5ldHRlUGFja1tdIH0ge1xuICAgIGxldCBuZXdQYWNrczogeyBbaWQ6IHN0cmluZ10gOiBNb3VsaW5ldHRlUGFja1tdIH0gPSB7fTtcbiAgICBmb3IoY29uc3QgcCBvZiBwYWNrcykge1xuICAgICAgbGV0IG5hbWUgPSBwLm5hbWUudHJpbSgpXG4gICAgICAvLyByZW1vdmUgSEQgLyA0SyBpbiBuYW1lc1xuICAgICAgaWYobmFtZS5lbmRzV2l0aChcIkhEXCIpIHx8IG5hbWUuZW5kc1dpdGgoXCI0S1wiKSkge1xuICAgICAgICBuYW1lID0gbmFtZS5zbGljZSgwLCAtMikudHJpbSgpXG4gICAgICB9XG4gICAgICAvLyByZW1vdmUgKC4uLikgaWYgYW55XG4gICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9cXChbXlxcKV0rXFwpL2csICcnKS50cmltKCk7XG4gICAgICAvLyBhZGQgdG8gbGlzdFxuICAgICAgaWYobmFtZSBpbiBuZXdQYWNrcykge1xuICAgICAgICBuZXdQYWNrc1tuYW1lXS5wdXNoKHApXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgbmV3UGFja3NbbmFtZV0gPSBbcF1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld1BhY2tzXG4gIH1cblxufSIsICJpbXBvcnQgeyBNb3VsaW5ldHRlQXNzZXQsIE1vdWxpbmV0dGVDcmVhdG9yLCBNb3VsaW5ldHRlSW1hZ2UsIE1vdWxpbmV0dGVQYWNrLCBNb3VsaW5ldHRlU291bmQsIE1vdWxpbmV0dGVUZXh0IH0gZnJvbSBcIm1vdWxpbmV0dGUtZW50aXRpZXNcIjtcbmltcG9ydCB7IE1vdWxpbmV0dGVTZWFyY2hNb2RhbCB9IGZyb20gXCJtb3VsaW5ldHRlLXNlYXJjaFwiO1xuaW1wb3J0IHsgTW91bGluZXR0ZVV0aWxzIH0gZnJvbSBcIm1vdWxpbmV0dGUtdXRpbHNcIjtcbmltcG9ydCB7IHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGNsYXNzIE1vdWxpbmV0dGVBc3NldFJlc3VsdCB7XG5cbiAgbmFtZTogc3RyaW5nOyAgICAgICAgIC8vIGFzc2V0J3MgbmFtZVxuICBwYWNrOiBzdHJpbmc7ICAgICAgICAgLy8gcGFjaydzIG5hbWVcbiAgY3JlYXRvcjogc3RyaW5nOyAgICAgIC8vIGNyZWF0b3IncyBuYW1lXG4gIHR5cGU6IHN0cmluZzsgICAgICAgICAvLyB0eXBlIG9mIGFzc2V0XG4gIHRodW1iVXJsOiBzdHJpbmc7ICAgICAvLyB0aHVtYiBVUkxcbiAgdXJsOiBzdHJpbmc7ICAgICAgICAgIC8vIGFzc2V0IFVSTFxuICByZWY6IE1vdWxpbmV0dGVBc3NldDsgLy8gYWRkaXRpb25hbCBtZXRhZGF0YVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgYSBSZXN1bHQgaW5zdGFuY2UgZnJvbSBhIGdpdmVuIGVudGl0eVxuICAgKi9cbiAgc3RhdGljIGZyb21FbnRpdHkoYSA6IE1vdWxpbmV0dGVBc3NldCwgcCA6IE1vdWxpbmV0dGVQYWNrLCBjIDogTW91bGluZXR0ZUNyZWF0b3IpIHtcbiAgICBjb25zdCByZXMgPSBuZXcgTW91bGluZXR0ZUFzc2V0UmVzdWx0KClcbiAgICBcbiAgICByZXMubmFtZSA9IE1vdWxpbmV0dGVVdGlscy5iZWF1dGlmeU5hbWUoYS5wYXRoLnNwbGl0KFwiL1wiKS5wb3AoKSB8fCBcIlwiKVxuICAgIHJlcy5wYWNrID0gcC5uYW1lXG4gICAgcmVzLmNyZWF0b3IgPSBjLm5hbWVcbiAgICByZXMucmVmID0gYVxuXG4gICAgaWYoYSBpbnN0YW5jZW9mIE1vdWxpbmV0dGVJbWFnZSkge1xuICAgICAgcmVzLnVybCA9IGEuZ2V0VXJsKHApXG4gICAgICByZXMudGh1bWJVcmwgPSBgJHtwLnBhdGh9LyR7YS5wYXRoLnNwbGl0KCcuJykuc2xpY2UoMCwgLTEpLmpvaW4oJy4nKX1fdGh1bWIud2VicD8ke3Auc2FzID8gcC5zYXMgOiBcIlwifWBcbiAgICB9XG4gICAgZWxzZSBpZihhIGluc3RhbmNlb2YgTW91bGluZXR0ZVNvdW5kKSB7XG4gICAgICByZXMudXJsID0gYS5nZXRVcmwocClcbiAgICB9XG4gICAgZWxzZSBpZihhIGluc3RhbmNlb2YgTW91bGluZXR0ZVRleHQpIHtcbiAgICAgIHJlcy51cmwgPSBhLmdldFVybChwKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICByZXR1cm4gcmVzXG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGEgVmlldyBmb3IgdGhpcyByZXN1bHRcbiAgICovXG4gIHJlbmRlckhUTUwobW9kYWwgOiBNb3VsaW5ldHRlU2VhcmNoTW9kYWwsIGNvbnRhaW5lckVsIDogRWxlbWVudCkge1xuICAgIGNvbnN0IGFzc2V0ID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiYXNzZXRcIiB9KTtcbiAgICBcbiAgICBzd2l0Y2godGhpcy5yZWYuY29uc3RydWN0b3IubmFtZSkge1xuICAgICAgY2FzZSBcIk1vdWxpbmV0dGVJbWFnZVwiOiBcbiAgICAgICAgYXNzZXQuY3JlYXRlRWwoXCJpbWdcIikuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLnRodW1iVXJsKTsgXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIk1vdWxpbmV0dGVTb3VuZFwiOiBcbiAgICAgICAgc2V0SWNvbihhc3NldC5jcmVhdGVEaXYoeyBjbHM6ICdpY29uJ30pLCBcIm11c2ljXCIpXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIk1vdWxpbmV0dGVUZXh0XCI6IFxuICAgICAgICBzZXRJY29uKGFzc2V0LmNyZWF0ZURpdih7IGNsczogJ2ljb24nfSksIFwiZmlsZS10ZXh0XCIpXG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBpbmZvID0gYXNzZXQuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiaW5mb1wiIH0pO1xuICAgIGluZm8uY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiB0aGlzLm5hbWUsIGNsczogXCJ0aXRsZVwiIH0pXG4gICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGAke3RoaXMucGFja30gKCR7dGhpcy5jcmVhdG9yfSlgLCBjbHM6IFwicGFja1wiIH0pXG5cbiAgICBpZih0aGlzLnJlZiBpbnN0YW5jZW9mIE1vdWxpbmV0dGVUZXh0KSB7XG4gICAgICBpZih0aGlzLnJlZi5kZXNjcmlwdGlvbikge1xuICAgICAgICBpbmZvLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogdGhpcy5yZWYuZGVzY3JpcHRpb24sIGNsczogXCJkZXNjXCIgfSkgIFxuICAgICAgfVxuICAgICAgaWYodGhpcy5yZWYudHlwZSkge1xuICAgICAgICBjb25zdCB0YWdzID0gaW5mby5jcmVhdGVEaXYoXCJtZXRhXCIpXG4gICAgICAgIGNvbnN0IHR5cGVWYWwgPSB0aGlzLnJlZi50eXBlXG4gICAgICAgIHRhZ3MuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiB0eXBlVmFsLCBjbHM6IFwidGFnXCIsIHRpdGxlOiBcIlR5cGVcIiB9KS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2KSA9PiB7IFxuICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIG1vZGFsLmFwcGx5RmlsdGVyKFwidHlwZVwiLCB0eXBlVmFsKVxuICAgICAgICB9KVxuICAgICAgICBpZih0aGlzLnJlZi5zdWJ0eXBlKSB7XG4gICAgICAgICAgY29uc3Qgc3VidHlwZVZhbCA9IHRoaXMucmVmLnN1YnR5cGVcbiAgICAgICAgICB0YWdzLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogc3VidHlwZVZhbCwgY2xzOiBcInRhZ1wiLCB0aXRsZTogXCJTdWJ0eXBlXCIgfSkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldikgPT4geyBcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgbW9kYWwuYXBwbHlGaWx0ZXIoXCJzdWJ0eXBlXCIsIHN1YnR5cGVWYWwpXG4gICAgICAgICAgfSlcblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IE1vdWxpbmV0dGVVdGlscy5mb3JtYXREdXJhdGlvbihOdW1iZXIodGhpcy5tZXRhLmR1cmF0aW9uKSksIGNsczogXCJkdXJhdGlvblwiIH0pXG4gIH1cbn0iLCAiaW1wb3J0IE1vdWxpbmV0dGVQbHVnaW4gZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1vdWxpbmV0dGVDbGllbnQgfSBmcm9tIFwibW91bGluZXR0ZS1jbGllbnRcIjtcbmltcG9ydCB7IE1vdWxpbmV0dGVBc3NldCwgTW91bGluZXR0ZUNyZWF0b3IsIE1vdWxpbmV0dGVJbWFnZSwgTW91bGluZXR0ZVNvdW5kLCBNb3VsaW5ldHRlVGV4dCB9IGZyb20gXCJtb3VsaW5ldHRlLWVudGl0aWVzXCI7XG5pbXBvcnQgeyBNb3VsaW5ldHRlQXNzZXRSZXN1bHQgfSBmcm9tIFwibW91bGluZXR0ZS1yZXN1bHRzXCI7XG5pbXBvcnQgeyBNb3VsaW5ldHRlVXRpbHMgfSBmcm9tIFwibW91bGluZXR0ZS11dGlsc1wiO1xuaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFN1Z2dlc3RNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbnRlcmZhY2UgRmlsdGVyVGFnIHtcbiAgaWQ6IHN0cmluZ1xuICB2YWx1ZTogc3RyaW5nXG59XG5cbmNsYXNzIE1vdWxpbmV0dGVGaWx0ZXJzIHtcbiAgc3RhdGljIEFTU0VUX1RZUEVfQU5ZICAgID0gMFxuICBzdGF0aWMgQVNTRVRfVFlQRV9JTUFHRVMgPSAxIC8vIFwiIWlcIlxuICBzdGF0aWMgQVNTRVRfVFlQRV9TT1VORFMgPSAyIC8vIFwiIXNcIlxuICBzdGF0aWMgQVNTRVRfVFlQRV9URVhUICAgPSAzIC8vIFwiIXRcIlxuICBcbiAgYXNzZXRUeXBlOiBudW1iZXJcbiAgdGFnczogRmlsdGVyVGFnW11cbiAgdGVybXM6IHN0cmluZ1tdXG5cbiAgY29uc3RydWN0b3IocXVlcnk6IHN0cmluZykge1xuICAgIHRoaXMuYXNzZXRUeXBlID0gTW91bGluZXR0ZUZpbHRlcnMuQVNTRVRfVFlQRV9BTllcbiAgICB0aGlzLnRhZ3MgPSBbXVxuICAgIHRoaXMudGVybXMgPSBbXVxuICAgIFxuICAgIGNvbnN0IHRlcm1zID0gcXVlcnkuc3BsaXQoXCIgXCIpXG4gICAgZm9yKGNvbnN0IHQgb2YgdGVybXMpIHtcbiAgICAgIC8vIGlnbm9yZSBleHRyYSBzcGFjZXNcbiAgICAgIGlmKHQubGVuZ3RoID09IDApIGNvbnRpbnVlXG4gICAgICAvLyBpZ25vcmUgZW1wdHkgdHlwZVxuICAgICAgZWxzZSBpZih0ID09IFwiIVwiKSBjb250aW51ZVxuICAgICAgLy8gZmlsdGVyIGJ5IHR5cGVcbiAgICAgIGVsc2UgaWYodCA9PSBcIiFpXCIgfHwgdCA9PSBcImkhXCIpIHRoaXMuYXNzZXRUeXBlID0gTW91bGluZXR0ZUZpbHRlcnMuQVNTRVRfVFlQRV9JTUFHRVNcbiAgICAgIGVsc2UgaWYodCA9PSBcIiFzXCIgfHwgdCA9PSBcInMhXCIpIHRoaXMuYXNzZXRUeXBlID0gTW91bGluZXR0ZUZpbHRlcnMuQVNTRVRfVFlQRV9TT1VORFNcbiAgICAgIGVsc2UgaWYodCA9PSBcIiF0XCIgfHwgdCA9PSBcInQhXCIpIHRoaXMuYXNzZXRUeXBlID0gTW91bGluZXR0ZUZpbHRlcnMuQVNTRVRfVFlQRV9URVhUXG4gICAgICAvLyBmaWx0ZXIgYnkgdGFnXG4gICAgICBlbHNlIGlmKHQuc3RhcnRzV2l0aChcIiNcIikpIHtcbiAgICAgICAgY29uc3QgdGFnID0gdC5zdWJzdHJpbmcoMSkuc3BsaXQoXCI6XCIpXG4gICAgICAgIGlmKHRhZy5sZW5ndGggPT0gMikge1xuICAgICAgICAgIHRoaXMudGFncy5wdXNoKHsgaWQ6IHRhZ1swXSwgdmFsdWU6IHRhZ1sxXX0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIGZpbHRlciBieSB0ZXh0XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy50ZXJtcy5wdXNoKHQpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbWF0Y2hlcyhhc3NldDogTW91bGluZXR0ZUFzc2V0KSB7XG4gICAgLy8gY2hlY2sgdHlwZVxuICAgIGlmKHRoaXMuYXNzZXRUeXBlID09IE1vdWxpbmV0dGVGaWx0ZXJzLkFTU0VUX1RZUEVfSU1BR0VTICYmICEoYXNzZXQgaW5zdGFuY2VvZiBNb3VsaW5ldHRlSW1hZ2UpKSByZXR1cm4gZmFsc2VcbiAgICBpZih0aGlzLmFzc2V0VHlwZSA9PSBNb3VsaW5ldHRlRmlsdGVycy5BU1NFVF9UWVBFX1NPVU5EUyAmJiAhKGFzc2V0IGluc3RhbmNlb2YgTW91bGluZXR0ZVNvdW5kKSkgcmV0dXJuIGZhbHNlXG4gICAgaWYodGhpcy5hc3NldFR5cGUgPT0gTW91bGluZXR0ZUZpbHRlcnMuQVNTRVRfVFlQRV9URVhUICYmICEoYXNzZXQgaW5zdGFuY2VvZiBNb3VsaW5ldHRlVGV4dCkpIHJldHVybiBmYWxzZVxuICAgIC8vIGNoZWNrIHRhZ3NcbiAgICBpZih0aGlzLnRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgaWYoIShhc3NldCBpbnN0YW5jZW9mIE1vdWxpbmV0dGVUZXh0KSkgcmV0dXJuIGZhbHNlXG4gICAgICBmb3IoY29uc3QgdCBvZiB0aGlzLnRhZ3MpIHtcbiAgICAgICAgaWYodC5pZCA9PSBcInR5cGVcIiAmJiBhc3NldC50eXBlICE9IHQudmFsdWUpIHJldHVybiBmYWxzZVxuICAgICAgICBpZih0LmlkID09IFwic3VidHlwZVwiICYmIGFzc2V0LnN1YnR5cGUgIT0gdC52YWx1ZSkgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfVxuICAgIC8vIGNoZWNrIHRlcm1zXG4gICAgZm9yKGNvbnN0IHQgb2YgdGhpcy50ZXJtcykge1xuICAgICAgLy8gbWF0Y2ggaW4gcGF0aFxuICAgICAgaWYoYXNzZXQucGF0aCAmJiBhc3NldC5wYXRoLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5kZXhPZih0LnRvTG9jYWxlTG93ZXJDYXNlKCkpID49IDApIGNvbnRpbnVlXG4gICAgICAvLyBtYXRjaCBpbiBkZXNjcml0aW9uXG4gICAgICBpZihhc3NldCBpbnN0YW5jZW9mIE1vdWxpbmV0dGVUZXh0ICYmIGFzc2V0LmRlc2NyaXB0aW9uICYmIGFzc2V0LmRlc2NyaXB0aW9uLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5kZXhPZih0LnRvTG9jYWxlTG93ZXJDYXNlKCkpID49IDApIGNvbnRpbnVlXG4gICAgICAvLyBub3QgbWF0Y2ggZm9yIHRoYXQgdGVybWVcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBNb3VsaW5ldHRlU2VhcmNoTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8TW91bGluZXR0ZUFzc2V0UmVzdWx0PiB7XG5cbiAgc3RhdGljIE1BWF9SRVNVTFRTID0gMTAwXG4gIFxuICBwbHVnaW46IE1vdWxpbmV0dGVQbHVnaW5cbiAgY3JlYXRvcnM6IE1vdWxpbmV0dGVDcmVhdG9yW107XG5cbiAgY29uc3RydWN0b3IocGx1Z2luOiBNb3VsaW5ldHRlUGx1Z2luLCBjcmVhdG9yczogTW91bGluZXR0ZUNyZWF0b3JbXSkge1xuICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXG4gICAgdGhpcy5jcmVhdG9ycyA9IGNyZWF0b3JzXG4gIH1cblxuICAvLyBSZXR1cm5zIGFsbCBhdmFpbGFibGUgc3VnZ2VzdGlvbnMuXG4gIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBNb3VsaW5ldHRlQXNzZXRSZXN1bHRbXSB7XG4gICAgY29uc3QgZmlsdGVycyA9IG5ldyBNb3VsaW5ldHRlRmlsdGVycyhxdWVyeSlcbiAgICBcbiAgICBjb25zdCByZXN1bHRzOiBNb3VsaW5ldHRlQXNzZXRSZXN1bHRbXSA9IFtdXG4gICAgZm9yKGNvbnN0IGMgb2YgdGhpcy5jcmVhdG9ycykge1xuICAgICAgZm9yKGNvbnN0IHAgb2YgYy5wYWNrcykge1xuICAgICAgICBmb3IoY29uc3QgYSBvZiBwLmFzc2V0cykge1xuICAgICAgICAgIGlmKGZpbHRlcnMubWF0Y2hlcyhhKSkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gTW91bGluZXR0ZUFzc2V0UmVzdWx0LmZyb21FbnRpdHkoYSwgcCwgYylcbiAgICAgICAgICAgIGlmKHJlc3VsdCkge1xuICAgICAgICAgICAgICByZXN1bHRzLnB1c2gocmVzdWx0KVxuICAgICAgICAgICAgICBpZihyZXN1bHRzLmxlbmd0aCA+PSBNb3VsaW5ldHRlU2VhcmNoTW9kYWwuTUFYX1JFU1VMVFMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0c1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzXG4gIH1cblxuICAvLyBSZW5kZXJzIGVhY2ggc3VnZ2VzdGlvbiBpdGVtLlxuICByZW5kZXJTdWdnZXN0aW9uKHJlczogTW91bGluZXR0ZUFzc2V0UmVzdWx0LCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICByZXMucmVuZGVySFRNTCh0aGlzLCBlbClcbiAgfVxuXG4gIC8vIFBlcmZvcm0gYWN0aW9uIG9uIHRoZSBzZWxlY3RlZCBzdWdnZXN0aW9uLlxuICBvbkNob29zZVN1Z2dlc3Rpb24ocmVzOiBNb3VsaW5ldHRlQXNzZXRSZXN1bHQsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAvLyBEb3dubG9hZCAmIGluc2VydCBpbWFnZVxuICAgIGlmKHJlcy51cmwuc3RhcnRzV2l0aChNb3VsaW5ldHRlQ2xpZW50LlJFTU9URV9CQVNFKSkge1xuICAgICAgTW91bGluZXR0ZVV0aWxzLmRvd25sb2FkRmlsZSh0aGlzLnBsdWdpbi5hcHAudmF1bHQsIHJlcy51cmwpLnRoZW4oIChpbWdQYXRoKSA9PiB7XG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSB1c2VyIGlzIGVkaXRpbmcgYSBNYXJrZG93biBmaWxlLlxuICAgICAgICBpZiAoaW1nUGF0aCAmJiB2aWV3KSB7XG4gICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihgIVtbJHtpbWdQYXRofV1dYClcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChgIVtbJHtpbWdQYXRofV1dYCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiTm8gYWN0aXZlIHZpZXcuIFBhdGggY29waWVkIGludG8gY2xpcGJvYXJkXCIpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgdmlldyBBTkQgY2Fubm90IHdyaXRlIGludG8gY2xpcGJvYXJkXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgICAvLyBEb3dubG9hZCAmIGluc2VydCBtYXJrZG93blxuICAgIGVsc2Uge1xuICAgICAgTW91bGluZXR0ZVV0aWxzLmRvd25sb2FkTWFya2Rvd24odGhpcy5wbHVnaW4sIHJlcy51cmwpLnRoZW4oIChtZFRleHQpID0+IHtcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBlZGl0aW5nIGEgTWFya2Rvd24gZmlsZS5cbiAgICAgICAgaWYgKG1kVGV4dCAmJiB2aWV3KSB7XG4gICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihtZFRleHQpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobWRUZXh0KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgdmlldy4gVGV4dCBjb3BpZWQgaW50byBjbGlwYm9hcmRcIik7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSB2aWV3IEFORCBjYW5ub3Qgd3JpdGUgaW50byBjbGlwYm9hcmRcIik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgYXBwbHlGaWx0ZXIodGFnTmFtZTogc3RyaW5nLCB0YWdWYWx1ZTogc3RyaW5nKSB7XG4gICAgLy8gaWYgdGFnIGFscmVhZHkgZXhpc3RzIChyZXBsYWNlIGl0ISlcbiAgICBjb25zdCBxdWVyeSA9IHRoaXMuaW5wdXRFbC52YWx1ZVxuICAgIGNvbnN0IGlkeCA9IHF1ZXJ5LmluZGV4T2YoYCMke3RhZ05hbWV9OmApXG4gICAgaWYoaWR4ID49IDApIHtcbiAgICAgIGxldCBuZXdRdWVyeSA9IHF1ZXJ5LnN1YnN0cmluZygwLCBpZHgpICsgYCMke3RhZ05hbWV9OiR7dGFnVmFsdWV9YFxuICAgICAgY29uc3QgaWRFID0gcXVlcnkuaW5kZXhPZihcIiBcIiwgaWR4KzEpXG4gICAgICBpZihpZEUgPj0gMCkge1xuICAgICAgICBuZXdRdWVyeSArPSBxdWVyeS5zdWJzdHJpbmcoaWRFKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmlucHV0RWwuc2V0UmFuZ2VUZXh0KGAgIyR7dGFnTmFtZX06JHt0YWdWYWx1ZX1gKVxuICAgIH1cbiAgICAvLyBwdXQgaW5wdXQgY3Vyc29yIGF0IHRoZSBlbmQgYW5kIHRyaWdnZXIgZXZlbnRcbiAgICB0aGlzLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQgPSB0aGlzLmlucHV0RWwuc2VsZWN0aW9uRW5kID0gdGhpcy5pbnB1dEVsLnZhbHVlLmxlbmd0aDtcbiAgICB0aGlzLmlucHV0RWwuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgfVxufSIsICJpbXBvcnQgeyBBcHAsIEJ1dHRvbkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTW91bGluZXR0ZVBsdWdpbiBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5nVGFiIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJztcbmltcG9ydCB7IE1vdWxpbmV0dGVDbGllbnQgfSBmcm9tICdtb3VsaW5ldHRlLWNsaWVudCc7XG5pbXBvcnQgeyBNb3VsaW5ldHRlVXRpbHMgfSBmcm9tICdtb3VsaW5ldHRlLXV0aWxzJztcblxuXG5leHBvcnQgY2xhc3MgTW91bGluZXR0ZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0XG4gIHBsdWdpbjogTW91bGluZXR0ZVBsdWdpbjtcbiAgaW50ZXJ2YWxSZWY6IG51bWJlcjsgIC8vIHJlZmVyZW5jZSB0byB3aW5kb3cuc2V0SW50ZXJ2YWwoKVxuICBpbnRlcnZhbEl0ZXI6IG51bWJlcjsgLy8gaW50ZXJ2YWwgaXRlcmF0aW9ucyAoY291bnQpXG4gIHdhcm46IEhUTUxEaXZFbGVtZW50O1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1vdWxpbmV0dGVQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5pbnRlcnZhbFJlZiA9IDBcbiAgICB0aGlzLmludGVydmFsSXRlciA9IDA7XG5cdH1cblxuICAvKipcbiAgICogRXh0cmEgY2xlYW51cCA6IG1ha2Ugc3VyZSBubyBhdXRoZW50aWNhdGlvbiBpbiBwcm9ncmVzc1xuICAgKi9cbiAgaGlkZSgpIHtcbiAgICBpZih0aGlzLmludGVydmFsUmVmKSB7XG4gICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsUmVmKVxuICAgIH1cbiAgICB0aGlzLndhcm4ucmVtb3ZlQ2xhc3MoXCJ2aXNpYmxlXCIpXG4gIH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEb3dubG9hZCBmb2xkZXInKVxuXHRcdFx0LnNldERlc2MoJ05hbWUgb2YgdGhlIGRpcmVjdG9yeSB3aGVyZSB0aGUgZmlsZXMgd2lsbCBiZSBkb3dubG9hZGVkLicpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdtb3VsaW5ldHRlJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRvd25sb2FkRm9sZGVyKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZG93bmxvYWRGb2xkZXIgPSB2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPiAwID8gdmFsdWUgOiBcIm1vdWxpbmV0dGVcIjtcbiAgICAgICAgICBNb3VsaW5ldHRlVXRpbHMuUFJFRklYID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZG93bmxvYWRGb2xkZXIgKyBcIi9cIlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnTW91bGluZXR0ZSBDbG91ZCBpbnRlZ3JhdGlvbicpLnNldEhlYWRpbmcoKTtcblxuICAgIHRoaXMucmVmcmVzaENsb3VkSW50ZWdyYXRpb24oY29udGFpbmVyRWwuY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtXCJ9KSlcblxuICAgIGNvbnN0IHJlZnJlc2hTZXR0aW5nID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtXCJ9KVxuICAgIGNvbnN0IGF1dGhJbmZvID0gcmVmcmVzaFNldHRpbmcuY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLWluZm9cIn0pXG4gICAgYXV0aEluZm8uY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLW5hbWVcIiwgdGV4dDogYFJlZnJlc2ggYXNzZXRzYH0pXG4gICAgYXV0aEluZm8uY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uXCIsIHRleHQ6IFwiVGhlIGxpc3Qgb2YgYXNzZXRzIHlvdSBoYXZlIGFjY2VzcyB0byBpcyBjYWNoZWQuIENsaWNrIHRoZSAnUmVmcmVzaCcgYnV0dG9uIHRvIGZvcmNlIGEgZGF0YSByZWZyZXNoIHdpdGhvdXQgdGhlIG5lZWQgdG8gcmVzdGFydCBPYnNpZGlhbi5cIn0pXG4gICAgY29uc3QgYWN0aW9ucyA9IHJlZnJlc2hTZXR0aW5nLmNyZWF0ZURpdih7Y2xzOiBcInNldHRpbmctaXRlbS1jb250cm9sXCJ9KS5jcmVhdGVEaXYoXCJhY3Rpb25zXCIpXG4gICAgY29uc3QgcmVmcmVzaEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYWN0aW9ucylcbiAgICAgIC5zZXRCdXR0b25UZXh0KFwiUmVmcmVzaFwiKVxuICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICByZWZyZXNoQnV0dG9uLnNldEJ1dHRvblRleHQoXCJcdTI3MTMgcmVmcmVzaGVkIVwiKVxuICAgICAgICByZWZyZXNoQnV0dG9uLnNldERpc2FibGVkKHRydWUpXG4gICAgICAgIHJlZnJlc2hCdXR0b24uc2V0Q2xhc3MoXCJzdWNjZXNzXCIpXG4gICAgICAgIHRoaXMucGx1Z2luLmNsZWFyQ2FjaGUoKVxuICAgIH0pXG5cdH1cblxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjbG91ZCBpbnRlZ3JhdGlvbiBzZXR0aW5ncyBzZWN0aW9uXG4gICAqIFxuICAgKiBAcGFyYW0gc2V0dGluZ0RJViBESVYgZWxlbWVudCB0byB1cGRhdGVcbiAgICovXG4gIGFzeW5jIHJlZnJlc2hDbG91ZEludGVncmF0aW9uKHNldHRpbmdESVYgOiBFbGVtZW50LCBmb3JjZT1mYWxzZSkge1xuICBcbiAgICBzZXR0aW5nRElWLmVtcHR5KClcbiAgICBjb25zdCBhdXRoSW5mbyA9IHNldHRpbmdESVYuY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLWluZm9cIn0pXG4gICAgXG4gICAgaWYodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2Vzc2lvbklEICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlc3Npb25JRC5sZW5ndGggPT0gMjYpIHtcbiAgICAgIC8vIGdldCB1c2VyIGluZm9cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBNb3VsaW5ldHRlQ2xpZW50LmdldFVzZXIodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2Vzc2lvbklELCBmb3JjZSlcbiAgICAgIGlmKHVzZXIgJiYgdXNlci5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgIC8vIEdVSUQgaGFzIGJlZW4gdXBkYXRlZCAoYWZ0ZXIgMjQgaG91cnMsIGZvciBzZWN1cml0eSByZWFzb25zKVxuICAgICAgICBpZih1c2VyLmRhdGEuZ3VpZCkge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlc3Npb25JRCA9IHVzZXIuZGF0YS5ndWlkXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgZGVsZXRlIHVzZXIuZGF0YS5ndWlkXG4gICAgICAgIH1cblxuICAgICAgICBpZih1c2VyLmRhdGEucGF0cm9uKSB7XG4gICAgICAgICAgYXV0aEluZm8uY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLW5hbWVcIiwgdGV4dDogYEF1dGhlbnRpY2F0ZWQgYXMgJyR7dXNlci5kYXRhLmZ1bGxOYW1lfScgKCMke3VzZXIuZGF0YS5pZH0pIGFuZCBzdXBwb3J0aW5nIE1vdWxpbmV0dGUgXHUyNjY1YH0pXG4gICAgICAgICAgY29uc3QgZGVzY3IgPSBhdXRoSW5mby5jcmVhdGVEaXYoe2NsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIn0pXG4gICAgICAgICAgZGVzY3IuY3JlYXRlU3Bhbih7IHRleHQ6IFwiVGllcnMgOlwifSlcbiAgICAgICAgICBjb25zdCB1bCA9IGRlc2NyLmNyZWF0ZUVsKFwidWxcIilcbiAgICAgICAgICBmb3IoY29uc3QgcGxlZGdlIG9mIHVzZXIuZGF0YS5wbGVkZ2VzKSB7XG4gICAgICAgICAgICBjb25zdCBsaSA9IHVsLmNyZWF0ZUVsKFwibGlcIilcbiAgICAgICAgICAgIGxpLmNyZWF0ZURpdih7IHRleHQgOiBgJHtwbGVkZ2UudmFuaXR5fTogJHtwbGVkZ2UucGxlZGdlfWAgfSlcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgYXV0aEN0cmwgPSBzZXR0aW5nRElWLmNyZWF0ZURpdih7Y2xzOiBcInNldHRpbmctaXRlbS1jb250cm9sXCJ9KVxuICAgICAgICAgIGNvbnN0IGFjdGlvbnMgPSBhdXRoQ3RybC5jcmVhdGVEaXYoXCJhY3Rpb25zXCIpXG4gICAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChhY3Rpb25zKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJSZWZyZXNoIHRpZXJzXCIpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLmNsZWFyQ2FjaGUoKVxuICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hDbG91ZEludGVncmF0aW9uKHNldHRpbmdESVYsIHRydWUpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIG5ldyBCdXR0b25Db21wb25lbnQoYWN0aW9ucylcbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiTG9nb3V0XCIpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlc3Npb25JRCA9ICcnXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5jbGVhckNhY2hlKClcbiAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQ2xvdWRJbnRlZ3JhdGlvbihzZXR0aW5nRElWKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhdXRoSW5mby5jcmVhdGVEaXYoe2NsczogXCJzZXR0aW5nLWl0ZW0tbmFtZVwiLCB0ZXh0OiBgQXV0aGVudGljYXRlZCBhcyAnJHt1c2VyLmRhdGEuZnVsbE5hbWV9JyAoIyR7dXNlci5kYXRhLmlkfSksIG5vdCBhIE1vdWxpbmV0dGUgbWVtYmVyYH0pXG4gICAgICAgICAgY29uc3QgZGVzY3IgPSBhdXRoSW5mby5jcmVhdGVEaXYoe2NsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIn0pXG4gICAgICAgICAgZGVzY3IuY3JlYXRlU3Bhbih7IHRleHQ6IFwiTW91bGluZXR0ZSBzdXBwb3J0IGlzIHJlcXVpcmVkIGZvciBhY2Nlc3NpbmcgY2xvdWQgZmVhdHVyZXMuIE5ldmVydGhlbGVzcywgeW91IGNhbiBzdGlsbCB1dGlsaXplIHRoZSBtb2R1bGUgd2l0aCB0aGUgYXZhaWxhYmxlIGRlbW8gZGF0YS5cIn0pXG4gICAgICAgICAgY29uc3QgYWN0aW9ucyA9IHNldHRpbmdESVYuY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIn0pLmNyZWF0ZURpdihcImFjdGlvbnNcIilcbiAgICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGFjdGlvbnMpXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkpvaW4gTW91bGluZXR0ZVwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICB3aW5kb3cub3BlbihcImh0dHBzOi8vd3d3LnBhdHJlb24uY29tL2pvaW4vbW91bGluZXR0ZVwiLCBcIl9ibGFua1wiKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGFjdGlvbnMpXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIlJlZnJlc2ggdGllcnNcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uY2xlYXJDYWNoZSgpXG4gICAgICAgICAgICAgIHRoaXMucmVmcmVzaENsb3VkSW50ZWdyYXRpb24oc2V0dGluZ0RJViwgdHJ1ZSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChhY3Rpb25zKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJMb2dvdXRcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2Vzc2lvbklEID0gJydcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uY2xlYXJDYWNoZSgpXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hDbG91ZEludGVncmF0aW9uKHNldHRpbmdESVYpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vZGVzY3IuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJCeSBsaW5raW5nIHlvdXIgVmF1bHQgdG8gTW91bGluZXR0ZSwgeW91IHdpbGwgYmUgYWJsZSB0byBlYXNpbHkgc2VhcmNoIGFuZCBkb3dubG9hZCBjb250ZW50IGZyb20gY3JlYXRvcnMgYW5kIGNvbW11bml0aWVzLlwifSApXG4gICAgICAvL2Rlc2NyLmNyZWF0ZUVsKFwiYVwiLCB7IGhyZWY6IFwiaHR0cHM6Ly93d3cubW91bGluZXR0ZS5jbG91ZC9cIiwgdGV4dDogXCJMZWFybiBtb3JlIGFib3V0IE1vdWxpbmV0dGVcIn0gKVxuICAgICAgLy9jb25zdCB3YXJuID0gZGVzY3IuY3JlYXRlRGl2KHsgY2xzOiBcInNldHRpbmctd2FybmluZ1wiLCB0ZXh0OiBcIkF1dGhlbnRpY2F0aW9uIGluIHByb2dyZXNzIGluIHlvdXIgd2ViIGJyb3dzZXIuIFlvdSBoYXZlIDIgbWludXRlcyB0byBjb21wbGV0ZSB0aGUgcHJvY2VzcyFcIn0gKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IG5ld0dVSUQgPSByYW5kb21VVUlEKCkucmVwbGFjZSgvLS9nLCAnJykuc3Vic3RyaW5nKDAsIDI2KVxuICAgICAgY29uc3QgY2FsbGJhY2sgPSBgJHtNb3VsaW5ldHRlQ2xpZW50LlNFUlZFUl9VUkx9L3BhdHJlb24vY2FsbGJhY2tgXG4gICAgICBjb25zdCBwYXRyZW9uVVJMID0gYGh0dHBzOi8vd3d3LnBhdHJlb24uY29tL29hdXRoMi9hdXRob3JpemU/cmVzcG9uc2VfdHlwZT1jb2RlJmNsaWVudF9pZD0ke01vdWxpbmV0dGVDbGllbnQuQ0xJRU5UX0lEfSZyZWRpcmVjdF91cmk9JHtjYWxsYmFja30mc2NvcGU9aWRlbnRpdHkgaWRlbnRpdHkubWVtYmVyc2hpcHMmc3RhdGU9JHtuZXdHVUlEfWBcbiAgICAgIFxuICAgICAgYXV0aEluZm8uY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLW5hbWVcIiwgdGV4dDogXCJZb3VyIFZhdWx0IGlzIG5vdCBsaW5rZWQgdG8gTW91bGluZXR0ZSB5ZXRcIn0pXG4gICAgICBjb25zdCBkZXNjciA9IGF1dGhJbmZvLmNyZWF0ZURpdih7Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvblwifSlcbiAgICAgIGRlc2NyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiQnkgbGlua2luZyB5b3VyIFZhdWx0IHRvIE1vdWxpbmV0dGUsIHlvdSB3aWxsIGJlIGFibGUgdG8gZWFzaWx5IHNlYXJjaCBhbmQgZG93bmxvYWQgY29udGVudCBmcm9tIGNyZWF0b3JzIGFuZCBjb21tdW5pdGllcy4gXCJ9IClcbiAgICAgIGRlc2NyLmNyZWF0ZUVsKFwiYVwiLCB7IGhyZWY6IFwiaHR0cHM6Ly93d3cubW91bGluZXR0ZS5jbG91ZC9cIiwgdGV4dDogXCJMZWFybiBtb3JlIGFib3V0IE1vdWxpbmV0dGVcIn0gKVxuICAgICAgdGhpcy53YXJuID0gZGVzY3IuY3JlYXRlRGl2KHsgY2xzOiBcInNldHRpbmctd2FybmluZ1wiLCB0ZXh0OiBcIkF1dGhlbnRpY2F0aW9uIGluIHByb2dyZXNzIGluIHlvdXIgd2ViIGJyb3dzZXIuIFlvdSBoYXZlIDIgbWludXRlcyB0byBjb21wbGV0ZSB0aGUgcHJvY2VzcyFcIn0gKVxuICAgICAgXG4gICAgICBjb25zdCBhdXRoQ3RybCA9IHNldHRpbmdESVYuY3JlYXRlRGl2KHtjbHM6IFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIn0pXG4gICAgICBjb25zdCBidXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGF1dGhDdHJsLmNyZWF0ZURpdihcImFjdGlvbnNcIikpXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQXV0aGVudGljYXRlXCIpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICB3aW5kb3cub3BlbihwYXRyZW9uVVJMLCBcIl9ibGFua1wiKVxuICAgICAgICAgIHRoaXMud2Fybi5hZGRDbGFzcyhcInZpc2libGVcIikgLy8gc2hvdyB3YXJuaW5nIChwcm9jZXNzIGluIHByb2dyZXNzKVxuXG4gICAgICAgICAgLy8gY2hlY2sgZXZlcnkgMiBzZWNvbmRzIGlmIGF1dGhlbnRpY2F0aW9uIHdhcyBzdWNjZXNzZnVsbHkgY29tcGxldGVkXG4gICAgICAgICAgdGhpcy5pbnRlcnZhbEl0ZXIgPSAxMjBcbiAgICAgICAgICB0aGlzLmludGVydmFsUmVmID0gd2luZG93LnNldEludGVydmFsKCBhc3luYygpID0+IHtcbiAgICAgICAgICAgIC8vIHN0b3AgYWZ0ZXIgMiBtaW51dGVzIG1heGltdW1cbiAgICAgICAgICAgIGlmKHRoaXMuaW50ZXJ2YWxJdGVyIDw9IDApIHtcbiAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoYFJldHJ5YClcbiAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxSZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbnRlcnZhbEl0ZXItLTtcbiAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KGAke3RoaXMuaW50ZXJ2YWxJdGVyfSBzZWNgKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZih0aGlzLmludGVydmFsSXRlciAlIDIpIHtcbiAgICAgICAgICAgICAgY29uc3QgcmVhZHkgPSBhd2FpdCBNb3VsaW5ldHRlQ2xpZW50LmdldChgL3VzZXIvJHtuZXdHVUlEfS9yZWFkeT9wYXRyZW9uPTFgKVxuICAgICAgICAgICAgICBpZihyZWFkeSAmJiByZWFkeS5zdGF0dXMgPT0gMjAwICYmIHJlYWR5LmRhdGEuc3RhdHVzID09IFwieWVzXCIpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsUmVmKTtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgc2V0dGluZ3NcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uSUQgPSBuZXdHVUlEXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uY2xlYXJDYWNoZSgpXG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQ2xvdWRJbnRlZ3JhdGlvbihzZXR0aW5nRElWKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICAgIFxuICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iLCAiaW1wb3J0IE1vdWxpbmV0dGVQbHVnaW4gZnJvbSAnbWFpbic7XG5pbXBvcnQgeyBNb3VsaW5ldHRlQXNzZXQsIE1vdWxpbmV0dGVDcmVhdG9yLCBNb3VsaW5ldHRlSW1hZ2UsIE1vdWxpbmV0dGVQYWNrLCBNb3VsaW5ldHRlU291bmQsIE1vdWxpbmV0dGVUZXh0IH0gZnJvbSBcIm1vdWxpbmV0dGUtZW50aXRpZXNcIjtcbmltcG9ydCB7IE1vdWxpbmV0dGVVdGlscyB9IGZyb20gXCJtb3VsaW5ldHRlLXV0aWxzXCI7XG5pbXBvcnQgeyBBcHAsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgTW91bGluZXR0ZUJyb3dzZXJGaWx0ZXJzIHtcbiAgY3JlYXRvcjogbnVtYmVyID0gLTFcbiAgcGFja3M6IG51bWJlcltdID0gW11cbiAgdHlwZTogbnVtYmVyID0gMFxuICB0ZXJtczogc3RyaW5nID0gJydcbn1cblxuZXhwb3J0IGNsYXNzIE1vdWxpbmV0dGVCcm93c2VyIGV4dGVuZHMgTW9kYWwge1xuICBcbiAgc3RhdGljIE1BWF9BU1NFVFMgPSAxMDBcbiAgc3RhdGljIFNFQVJDSF9ERUxBWSA9IDYwMFxuXG4gIHBsdWdpbjogTW91bGluZXR0ZVBsdWdpblxuICBjcmVhdG9yczogTW91bGluZXR0ZUNyZWF0b3JbXSAgICAgLy8gbGlzdCBvZiBhbGwgY3JlYXRvcnNcbiAgZmlsdGVyczogTW91bGluZXR0ZUJyb3dzZXJGaWx0ZXJzIFxuICBhc3NldHNFbDogSFRNTEVsZW1lbnQgICAgICAgICAgICAgLy8gSFRNTCBkaXYgZm9yIHJlbmRlcmluZyBhc3NldHNcbiAgaWdub3JlU2Nyb2xsOiBib29sZWFuICAgICAgICAgICAgIC8vIGZsYWcgdG8gaWdub3JlIHNjcm9sbFxuICBwYWdlOiBudW1iZXIgICAgICAgICAgICAgICAgICAgICAgLy8gcmVuZGVyZWQgcGFnZSAocGFnaW5hdGlvbilcbiAga2V5VXBUaW1lclJlZjogbnVtYmVyICAgICAgICAgICAgIC8vIHRpbWVyIHRvIGRlbGF5IGtleXVwIGV2ZW50XG4gIFxuICBjb25zdHJ1Y3RvcihwbHVnaW46IE1vdWxpbmV0dGVQbHVnaW4sIGNyZWF0b3JzOiBNb3VsaW5ldHRlQ3JlYXRvcltdLCBmaWx0ZXJzOiBNb3VsaW5ldHRlQnJvd3NlckZpbHRlcnMpIHtcbiAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxuICAgIHRoaXMuY3JlYXRvcnMgPSBjcmVhdG9ycy5zb3J0KChhLGIpID0+IGEubmFtZS50b0xvY2FsZUxvd2VyQ2FzZSgpLmxvY2FsZUNvbXBhcmUoYi5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkpKVxuICAgIHRoaXMuZmlsdGVycyA9IGZpbHRlcnMgPyBmaWx0ZXJzIDogbmV3IE1vdWxpbmV0dGVCcm93c2VyRmlsdGVycygpXG4gICAgdGhpcy5rZXlVcFRpbWVyUmVmID0gMFxuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwucGFyZW50RWxlbWVudD8uYWRkQ2xhc3MoXCJicm93c2VyXCIpXG4gICAgXG4gICAgLy9jb250ZW50RWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiTW91bGluZXR0ZSBCcm93c2VyXCIgfSk7XG4gICAgY29uc3QgaGVhZGVyRWwgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2VhcmNoYmFyXCIgfSk7XG4gICAgY29uc3Qgc2VhcmNoRWwgPSBoZWFkZXJFbC5jcmVhdGVFbChcImlucHV0XCIsIHsgdmFsdWU6IHRoaXMuZmlsdGVycy50ZXJtcywgcGxhY2Vob2xkZXI6IFwiU2VhcmNoIC4uLlwifSlcbiAgICBzZWFyY2hFbC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKCkgPT4geyBcbiAgICAgIGlmKHRoaXMua2V5VXBUaW1lclJlZikgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLmtleVVwVGltZXJSZWYpXG4gICAgICB0aGlzLmtleVVwVGltZXJSZWYgPSB3aW5kb3cuc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgICB0aGlzLmZpbHRlcnMudGVybXMgPSBzZWFyY2hFbC52YWx1ZTtcbiAgICAgICAgdGhpcy51cGRhdGVEYXRhKHRydWUpXG4gICAgICB9LCBNb3VsaW5ldHRlQnJvd3Nlci5TRUFSQ0hfREVMQVkpXG4gICAgfSlcbiAgICBjb25zdCBjcmVhdG9yc0VsID0gaGVhZGVyRWwuY3JlYXRlRWwoXCJzZWxlY3RcIiwgeyB9KVxuICAgIGNyZWF0b3JzRWwuY3JlYXRlRWwoXCJvcHRpb25cIiwgeyB2YWx1ZTogJy0xJywgdGV4dDogYC0tIENyZWF0b3JzIC0tYCB9KVxuICAgIHRoaXMuY3JlYXRvcnMuZm9yRWFjaCgoYywgaWR4KSA9PiB7XG4gICAgICBjb25zdCBjb3VudCA9IGMucGFja3MucmVkdWNlKChhY2MsIG9iamV0KSA9PiBhY2MgKyBvYmpldC5hc3NldHMubGVuZ3RoLCAwKTtcbiAgICAgIGNvbnN0IG9wdGlvbiA9IGNyZWF0b3JzRWwuY3JlYXRlRWwoXCJvcHRpb25cIiwgeyB2YWx1ZTogJycgKyBpZHgsIHRleHQ6IGAke2MubmFtZX0gKCR7Y291bnQudG9Mb2NhbGVTdHJpbmcoKX0pYCB9KVxuICAgICAgaWYodGhpcy5maWx0ZXJzLmNyZWF0b3IgPT0gaWR4KSB7XG4gICAgICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICAgIH1cbiAgICB9KVxuICAgIGNvbnN0IHBhY2tzRWwgPSBoZWFkZXJFbC5jcmVhdGVFbChcInNlbGVjdFwiLCB7IH0pXG4gICAgcGFja3NFbC5jcmVhdGVFbChcIm9wdGlvblwiLCB7IHZhbHVlOiAnJywgdGV4dDogYC0tIFBhY2sgLS1gIH0pXG5cbiAgICBjcmVhdG9yc0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGV2KSA9PiB7XG4gICAgICB0aGlzLmZpbHRlcnMuY3JlYXRvciA9IE51bWJlcigoZXYudGFyZ2V0IGFzIEhUTUxTZWxlY3RFbGVtZW50KS52YWx1ZSk7XG4gICAgICB0aGlzLmZpbHRlcnMucGFja3MgPSBbXVxuICAgICAgdGhpcy5vblNlbGVjdENyZWF0b3IocGFja3NFbClcbiAgICAgIHRoaXMudXBkYXRlRGF0YSh0cnVlKVxuICAgIH0pO1xuXG4gICAgcGFja3NFbC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldikgPT4ge1xuICAgICAgY29uc3Qgc2VsUGFja3NWYWx1ZSA9IChldi50YXJnZXQgYXMgSFRNTFNlbGVjdEVsZW1lbnQpLnZhbHVlO1xuICAgICAgdGhpcy5maWx0ZXJzLnBhY2tzID0gc2VsUGFja3NWYWx1ZS5sZW5ndGggPT0gMCA/IFtdIDogc2VsUGFja3NWYWx1ZS5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludChpdGVtLCAxMCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMudXBkYXRlRGF0YSh0cnVlKVxuICAgIH0pO1xuXG4gICAgY29uc3QgaW1hZ2VCdXR0b24gPSBoZWFkZXJFbC5jcmVhdGVFbChcImJ1dHRvblwiLCB7IGNsczogdGhpcy5maWx0ZXJzLnR5cGUgPT0gTW91bGluZXR0ZUFzc2V0LlRZUEVfSU1BR0UgPyBcImhpZ2hsaWdodFwiIDogXCJcIn0pXG4gICAgc2V0SWNvbihpbWFnZUJ1dHRvbiwgXCJpbWFnZVwiKVxuICAgIGNvbnN0IGF1ZGlvQnV0dG9uID0gaGVhZGVyRWwuY3JlYXRlRWwoXCJidXR0b25cIiwgeyBjbHM6IHRoaXMuZmlsdGVycy50eXBlID09IE1vdWxpbmV0dGVBc3NldC5UWVBFX0FVRElPID8gXCJoaWdobGlnaHRcIiA6IFwiXCJ9KVxuICAgIHNldEljb24oYXVkaW9CdXR0b24sIFwibXVzaWNcIilcbiAgICBjb25zdCBtZEJ1dHRvbiA9IGhlYWRlckVsLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgY2xzOiB0aGlzLmZpbHRlcnMudHlwZSA9PSBNb3VsaW5ldHRlQXNzZXQuVFlQRV9URVhUID8gXCJoaWdobGlnaHRcIiA6IFwiXCJ9KVxuICAgIHNldEljb24obWRCdXR0b24sIFwiZmlsZS10ZXh0XCIpXG4gICAgXG4gICAgLy8gZmlsdGVyIGJ5IGFzc2V0IHR5cGVcbiAgICBpbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2KSA9PiB0aGlzLmFwcGx5VHlwZUZpbHRlcihNb3VsaW5ldHRlQXNzZXQuVFlQRV9JTUFHRSwgaW1hZ2VCdXR0b24sIGF1ZGlvQnV0dG9uLCBtZEJ1dHRvbikpXG4gICAgYXVkaW9CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldikgPT4gdGhpcy5hcHBseVR5cGVGaWx0ZXIoTW91bGluZXR0ZUFzc2V0LlRZUEVfQVVESU8sIGltYWdlQnV0dG9uLCBhdWRpb0J1dHRvbiwgbWRCdXR0b24pKVxuICAgIG1kQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXYpID0+IHRoaXMuYXBwbHlUeXBlRmlsdGVyKE1vdWxpbmV0dGVBc3NldC5UWVBFX1RFWFQsIGltYWdlQnV0dG9uLCBhdWRpb0J1dHRvbiwgbWRCdXR0b24pKVxuXG4gICAgdGhpcy5hc3NldHNFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoXCJhc3NldHNcIilcblxuICAgIHRoaXMuYXNzZXRzRWwuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCAoZXYpID0+IHtcbiAgICAgIGlmKHRoaXMuaWdub3JlU2Nyb2xsKSByZXR1cm47XG4gICAgICBjb25zdCBib3R0b20gPSB0aGlzLmFzc2V0c0VsLnNjcm9sbEhlaWdodCAtIHRoaXMuYXNzZXRzRWwuc2Nyb2xsVG9wXG4gICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmFzc2V0c0VsLmNsaWVudEhlaWdodFxuICAgICAgaWYoYm90dG9tIC0gMjAgPCBoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5pZ25vcmVTY3JvbGwgPSB0cnVlIC8vIGF2b2lkIG11bHRpcGxlIGV2ZW50cyB0byBvY2N1ciB3aGlsZSBzY3JvbGxpbmdcbiAgICAgICAgaWYodGhpcy5wYWdlID49IDApIHtcbiAgICAgICAgICB0aGlzLnBhZ2UrK1xuICAgICAgICAgIHRoaXMudXBkYXRlRGF0YShmYWxzZSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlnbm9yZVNjcm9sbCA9IGZhbHNlXG4gICAgICB9ICAgICAgXG4gICAgfSk7XG5cbiAgICAvLyBmb290ZXJcbiAgICBjb25zdCBmb290ZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZvb3RlclwifSlcbiAgICBjb25zdCBpY29uID0gZm9vdGVyLmNyZWF0ZURpdihcImRpdlwiKVxuICAgIHNldEljb24oaWNvbiwgXCJpbmZvXCIpXG4gICAgZm9vdGVyLmNyZWF0ZVNwYW4oe3RleHQ6IFwiSG9sZCBDVFJML0NvbW1hbmQga2V5IHRvIGRvd25sb2FkIG11bHRpcGxlIGFzc2V0cy5cIn0pXG5cbiAgICAvLyBpbml0IGZpbHRlcnNcbiAgICB0aGlzLm9uU2VsZWN0Q3JlYXRvcihwYWNrc0VsKVxuICAgIHRoaXMudXBkYXRlRGF0YSh0cnVlKVxuICB9XG5cbiAgb25DbG9zZSgpIHtcbiAgICBsZXQgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgdGhpcy5wbHVnaW4ubGFzdEZpbHRlcnMgPSB0aGlzLmZpbHRlcnNcbiAgICBpZih0aGlzLmtleVVwVGltZXJSZWYpIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5rZXlVcFRpbWVyUmVmKVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHBhY2tzIGxpc3RcbiAgICogQHBhcmFtIHBhY2tzRWwgSFRNTCBzZWxlY3QgbGlzdFxuICAgKi9cbiAgb25TZWxlY3RDcmVhdG9yKHBhY2tzRWw6IEhUTUxTZWxlY3RFbGVtZW50KSB7XG4gICAgLy8gdXBkYXRlIHBhY2tzXG4gICAgcGFja3NFbC5lbXB0eSgpXG4gICAgcGFja3NFbC5jcmVhdGVFbChcIm9wdGlvblwiLCB7IHZhbHVlOiAnJywgdGV4dDogYC0tIFBhY2tzIC0tYCB9KVxuICAgIGlmKHRoaXMuZmlsdGVycy5jcmVhdG9yID49IDApIHtcbiAgICAgIGNvbnN0IHBhY2tzID0gTW91bGluZXR0ZVV0aWxzLmNvbWJpbmVQYWNrcyh0aGlzLmNyZWF0b3JzW3RoaXMuZmlsdGVycy5jcmVhdG9yXS5wYWNrcylcbiAgICAgIGNvbnN0IHNvcnRlZE5hbWVzID0gT2JqZWN0LmtleXMocGFja3MpLnNvcnQoKGEsYikgPT4gYS50b0xvY2FsZUxvd2VyQ2FzZSgpLmxvY2FsZUNvbXBhcmUoYi50b0xvY2FsZUxvd2VyQ2FzZSgpKSlcbiAgICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5maWx0ZXJzLnBhY2tzLmpvaW4oKVxuICAgICAgZm9yKGNvbnN0IHNuIG9mIHNvcnRlZE5hbWVzKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHBhY2tzW3NuXS5tYXAoKHApID0+IHAuaWQpLmpvaW4oKVxuICAgICAgICBjb25zdCBjb3VudCA9IHBhY2tzW3NuXS5yZWR1Y2UoKGFjYywgY3VyKSA9PiBhY2MgKyBjdXIuYXNzZXRzLmxlbmd0aCwgMClcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gcGFja3NFbC5jcmVhdGVFbChcIm9wdGlvblwiLCB7IHZhbHVlOiB2YWx1ZXMsIHRleHQ6IGAke3NufSAoJHtjb3VudC50b0xvY2FsZVN0cmluZygpfSlgIH0pXG4gICAgICAgIGlmKHNlbGVjdGVkID09IHZhbHVlcykge1xuICAgICAgICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3NlbGVjdGVkJywgJ3NlbGVjdGVkJylcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFwcGx5VHlwZUZpbHRlcih0eXBlOiBudW1iZXIsIGltYWdlQnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCwgYXVkaW9CdXR0b246IEhUTUxCdXR0b25FbGVtZW50LCBtZEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQpIHtcbiAgICB0aGlzLmZpbHRlcnMudHlwZSA9IHRoaXMuZmlsdGVycy50eXBlID09IHR5cGUgPyAwIDogdHlwZVxuICAgIGlmKHRoaXMuZmlsdGVycy50eXBlID09IE1vdWxpbmV0dGVBc3NldC5UWVBFX0lNQUdFKSB7XG4gICAgICBpbWFnZUJ1dHRvbi5hZGRDbGFzcyhcImhpZ2hsaWdodFwiKVxuICAgIH0gZWxzZSB7XG4gICAgICBpbWFnZUJ1dHRvbi5yZW1vdmVDbGFzcyhcImhpZ2hsaWdodFwiKVxuICAgIH1cbiAgICBpZih0aGlzLmZpbHRlcnMudHlwZSA9PSBNb3VsaW5ldHRlQXNzZXQuVFlQRV9BVURJTykge1xuICAgICAgYXVkaW9CdXR0b24uYWRkQ2xhc3MoXCJoaWdobGlnaHRcIilcbiAgICB9IGVsc2Uge1xuICAgICAgYXVkaW9CdXR0b24ucmVtb3ZlQ2xhc3MoXCJoaWdobGlnaHRcIilcbiAgICB9XG4gICAgaWYodGhpcy5maWx0ZXJzLnR5cGUgPT0gTW91bGluZXR0ZUFzc2V0LlRZUEVfVEVYVCkge1xuICAgICAgbWRCdXR0b24uYWRkQ2xhc3MoXCJoaWdobGlnaHRcIilcbiAgICB9IGVsc2Uge1xuICAgICAgbWRCdXR0b24ucmVtb3ZlQ2xhc3MoXCJoaWdobGlnaHRcIilcbiAgICB9XG4gICAgdGhpcy51cGRhdGVEYXRhKHRydWUpIFxuICB9XG5cbiAgZ2VuZXJhdGVBc3NldEhUTUwocGFjazogTW91bGluZXR0ZVBhY2ssIGFzc2V0OiBNb3VsaW5ldHRlQXNzZXQsIGFzc2V0SWQ6IE51bWJlcikge1xuICAgIFxuICAgIGlmKGFzc2V0IGluc3RhbmNlb2YgTW91bGluZXR0ZUltYWdlKSB7XG4gICAgICBjb25zdCB1cmwgPSBgJHtwYWNrLnBhdGh9LyR7YXNzZXQucGF0aH1gLnJlcGxhY2UoXCIud2VicFwiLCBcIl90aHVtYi53ZWJwXCIpICsgKHBhY2suc2FzID8gXCI/XCIgKyBwYWNrLnNhcyA6IFwiXCIpXG4gICAgICBjb25zdCB0aHVtYiA9IHRoaXMuYXNzZXRzRWwuY3JlYXRlRWwoXCJpbWdcIilcbiAgICAgIHRodW1iLnNldEF0dHJpYnV0ZShcInNyY1wiLCB1cmwpXG4gICAgICB0aHVtYi5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBhc3NldC5wYXRoKVxuICAgICAgdGh1bWIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldikgPT4ge1xuICAgICAgICBjb25zdCBhc3NldFVSTCA9IGAke3BhY2sucGF0aH0vJHthc3NldC5wYXRofT9gICsgKHBhY2suc2FzID8gcGFjay5zYXMgOiBcIlwiKVxuICAgICAgICBNb3VsaW5ldHRlVXRpbHMuZG93bmxvYWRGaWxlKHRoaXMuYXBwLnZhdWx0LCBhc3NldFVSTCkudGhlbiggKGltZ1BhdGgpID0+IHtcbiAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHVzZXIgaXMgZWRpdGluZyBhIE1hcmtkb3duIGZpbGUuXG4gICAgICAgICAgaWYgKGltZ1BhdGggJiYgdmlldykge1xuICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihgIVtbJHtpbWdQYXRofV1dYClcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChgIVtbJHtpbWdQYXRofV1dYCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgdmlldy4gUGF0aCBjb3BpZWQgaW50byBjbGlwYm9hcmRcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSB2aWV3IEFORCBjYW5ub3Qgd3JpdGUgaW50byBjbGlwYm9hcmRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYoIWV2LmN0cmxLZXkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBJbWFnZSAke2ltZ1BhdGg/LnNwbGl0KFwiL1wiKS5wb3AoKX0gZG93bmxvYWRlZGApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfVxuICAgIGVsc2UgaWYoYXNzZXQgaW5zdGFuY2VvZiBNb3VsaW5ldHRlU291bmQpIHtcbiAgICAgIGNvbnN0IGFzc2V0RWwgPSB0aGlzLmFzc2V0c0VsLmNyZWF0ZURpdih7IGNsczogXCJzbmRcIiB9KVxuICAgICAgYXNzZXRFbC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBhc3NldC5wYXRoKVxuICAgICAgY29uc3QgdGh1bWIgPSBhc3NldEVsLmNyZWF0ZURpdigpXG4gICAgICBzZXRJY29uKHRodW1iLCBcIm11c2ljXCIpXG4gICAgICBjb25zdCBmaWxlbmFtZSA9IGFzc2V0LnBhdGguc3BsaXQoXCIvXCIpLnBvcCgpPy5zcGxpdChcIi5cIilbMF1cbiAgICAgIGFzc2V0RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiZHVyXCIsIHRleHQ6IE1vdWxpbmV0dGVVdGlscy5mb3JtYXREdXJhdGlvbihhc3NldC5kdXJhdGlvbikgfSlcbiAgICAgIGFzc2V0RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBmaWxlbmFtZSB9KVxuICAgICAgYXNzZXRFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2KSA9PiB7XG4gICAgICAgIGNvbnN0IGFzc2V0VVJMID0gYXNzZXQuZ2V0VXJsKHBhY2spXG4gICAgICAgIE1vdWxpbmV0dGVVdGlscy5kb3dubG9hZEZpbGUodGhpcy5hcHAudmF1bHQsIGFzc2V0VVJMKS50aGVuKCAoc25kUGF0aCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBlZGl0aW5nIGEgTWFya2Rvd24gZmlsZS5cbiAgICAgICAgICBpZiAoc25kUGF0aCAmJiB2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGAhW1ske3NuZFBhdGh9XV1gKVxuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGAhW1ske3NuZFBhdGh9XV1gKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSB2aWV3LiBQYXRoIGNvcGllZCBpbnRvIGNsaXBib2FyZFwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiTm8gYWN0aXZlIHZpZXcgQU5EIGNhbm5vdCB3cml0ZSBpbnRvIGNsaXBib2FyZFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZighZXYuY3RybEtleSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFNvdW5kICR7c25kUGF0aD8uc3BsaXQoXCIvXCIpLnBvcCgpfSBkb3dubG9hZGVkYCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9XG4gICAgZWxzZSBpZihhc3NldCBpbnN0YW5jZW9mIE1vdWxpbmV0dGVUZXh0KSB7XG4gICAgICBjb25zdCBhc3NldEVsID0gdGhpcy5hc3NldHNFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWRcIiB9KVxuICAgICAgYXNzZXRFbC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBhc3NldC5wYXRoKVxuICAgICAgY29uc3QgdGh1bWIgPSBhc3NldEVsLmNyZWF0ZURpdigpXG4gICAgICBzZXRJY29uKHRodW1iLCBcImZpbGUtdGV4dFwiKVxuICAgICAgY29uc3QgZmlsZW5hbWUgPSBhc3NldC5wYXRoLnNwbGl0KFwiL1wiKS5wb3AoKVxuICAgICAgYXNzZXRFbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGZpbGVuYW1lPy5lbmRzV2l0aChcIi5tZFwiKSA/IGZpbGVuYW1lLnNsaWNlKDAsIC0zKSA6IGZpbGVuYW1lIH0pXG4gICAgICBhc3NldEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXYpID0+IHtcbiAgICAgICAgY29uc3QgYXNzZXRVUkwgPSBhc3NldC5nZXRVcmwocGFjaylcbiAgICAgICAgTW91bGluZXR0ZVV0aWxzLmRvd25sb2FkTWFya2Rvd24odGhpcy5wbHVnaW4sIGFzc2V0VVJMKS50aGVuKCAobWRUZXh0KSA9PiB7XG4gICAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSB1c2VyIGlzIGVkaXRpbmcgYSBNYXJrZG93biBmaWxlLlxuICAgICAgICAgIGlmIChtZFRleHQgJiYgdmlldykge1xuICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihtZFRleHQpXG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobWRUZXh0KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSB2aWV3LiBUZXh0IGNvcGllZCBpbnRvIGNsaXBib2FyZFwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiTm8gYWN0aXZlIHZpZXcgQU5EIGNhbm5vdCB3cml0ZSBpbnRvIGNsaXBib2FyZFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZighZXYuY3RybEtleSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFRleHQgJHthc3NldC5wYXRofSBkb3dubG9hZGVkYCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9XG5cbiAgfVxuXG4gIHVwZGF0ZURhdGEoY2xlYXI6IGJvb2xlYW4pIHtcbiAgICBpZihjbGVhcikge1xuICAgICAgdGhpcy5hc3NldHNFbC5lbXB0eSgpXG4gICAgICB0aGlzLnBhZ2UgPSAwXG4gICAgfVxuXG4gICAgbGV0IGFzc2V0SWR4ID0gMFxuICAgIGxldCBub0FkZGl0aW9uID0gdHJ1ZVxuICAgIGNvbnN0IHRlcm1zID0gdGhpcy5maWx0ZXJzLnRlcm1zLmxlbmd0aCA+IDAgPyB0aGlzLmZpbHRlcnMudGVybXMudG9Mb2NhbGVMb3dlckNhc2UoKS5zcGxpdCgnICcpIDogbnVsbFxuICAgIFxuICAgIGNvbnN0IGNyZWF0b3JzID0gdGhpcy5maWx0ZXJzLmNyZWF0b3IgPj0gMCA/IFt0aGlzLmNyZWF0b3JzW3RoaXMuZmlsdGVycy5jcmVhdG9yXV0gOiB0aGlzLmNyZWF0b3JzXG4gICAgZm9yKGNvbnN0IGMgb2YgY3JlYXRvcnMpIHtcbiAgICAgIGZvcihjb25zdCBwIG9mIGMucGFja3MpIHtcbiAgICAgICAgaWYodGhpcy5maWx0ZXJzLnBhY2tzLmxlbmd0aCA+IDAgJiYgIXRoaXMuZmlsdGVycy5wYWNrcy5pbmNsdWRlcyhwLmlkKSkgY29udGludWVcbiAgXG4gICAgICAgIGxldCBhc3NldHMgPSBwLmFzc2V0c1xuICAgICAgICAvLyBmaWx0ZXIgYnkgdHlwZVxuICAgICAgICBpZih0aGlzLmZpbHRlcnMudHlwZSkge1xuICAgICAgICAgIGFzc2V0cyA9IGFzc2V0cy5maWx0ZXIoKGEpID0+IHRoaXMuZmlsdGVycy50eXBlID09IGEuZ2V0VHlwZSgpIClcbiAgICAgICAgfVxuICAgICAgICBpZih0ZXJtcykge1xuICAgICAgICAgIC8vIFRPTyBTTE9XISFcbiAgICAgICAgICAvL2NvbnN0IGZ1c2UgPSBuZXcgRnVzZShwLmFzc2V0cywgZnVzZU9wdGlvbnMpO1xuICAgICAgICAgIC8vY29uc3QgYXNzZXRzID0gZnVzZS5zZWFyY2godGhpcy5zZWFyY2hFbC52YWx1ZSlcbiAgICAgICAgICBhc3NldHMgPSBhc3NldHMuZmlsdGVyKChhKSA9PiB0ZXJtcy5maWx0ZXIoKHQpID0+IGEucGF0aC50b0xvY2FsZUxvd2VyQ2FzZSgpLmluZGV4T2YodCkgPj0gMCkubGVuZ3RoID09IHRlcm1zLmxlbmd0aClcbiAgICAgICAgICBhc3NldHMuZm9yRWFjaCgoYSwgaWR4KSA9PiB7XG4gICAgICAgICAgICBpZihhc3NldElkeCA+PSBNb3VsaW5ldHRlQnJvd3Nlci5NQVhfQVNTRVRTICogdGhpcy5wYWdlICYmIGFzc2V0SWR4IDwgKHRoaXMucGFnZSsxKSAqIE1vdWxpbmV0dGVCcm93c2VyLk1BWF9BU1NFVFMpIHtcbiAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUFzc2V0SFRNTChwLCBhLCBpZHgpXG4gICAgICAgICAgICAgIG5vQWRkaXRpb24gPSBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXNzZXRJZHgrK1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgYXNzZXRzLmZvckVhY2goKGEsIGlkeCkgPT4ge1xuICAgICAgICAgICAgaWYoYXNzZXRJZHggPj0gTW91bGluZXR0ZUJyb3dzZXIuTUFYX0FTU0VUUyAqIHRoaXMucGFnZSAmJiBhc3NldElkeCA8ICh0aGlzLnBhZ2UrMSkgKiBNb3VsaW5ldHRlQnJvd3Nlci5NQVhfQVNTRVRTKSB7XG4gICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVBc3NldEhUTUwocCwgYSwgaWR4KVxuICAgICAgICAgICAgICBub0FkZGl0aW9uID0gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFzc2V0SWR4KytcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmKG5vQWRkaXRpb24pIHtcbiAgICAgIHRoaXMucGFnZSA9IC0xXG4gICAgfVxuXG4gICAgLy8gbm8gcmVzdWx0XG4gICAgaWYoYXNzZXRJZHggPT0gMCkge1xuICAgICAgdGhpcy5hc3NldHNFbC5jcmVhdGVEaXYoeyB0ZXh0OiBcIk5vIHJlc3VsdHMgcm91bmRcIiB9KVxuICAgIH1cbiAgfVxufSIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBNb3VsaW5ldHRlUHJvZ3Jlc3MgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICBzdXBlcihhcHApO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwucGFyZW50RWxlbWVudD8uYWRkQ2xhc3MoXCJwcm9ncmVzc1wiKVxuICAgIGNvbnRlbnRFbC5hZGRDbGFzcyhcIm1lc3NhZ2VcIilcbiAgICBjb25zdCBpY29uID0gY29udGVudEVsLmNyZWF0ZURpdihcImRpdlwiKVxuICAgIHNldEljb24oaWNvbiwgXCJob3VyZ2xhc3NcIilcbiAgICBjb250ZW50RWwuY3JlYXRlRGl2KHsgdGV4dDogXCJEb3dubG9hZGluZyBNb3VsaW5ldHRlJ3MgaW5kZXguLi4gcGxlYXNlIHdhaXQhXCJ9KVxuICB9XG4gXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUFzRTs7O0FDSy9ELElBQWUsbUJBQWYsTUFBK0I7QUFBQSxFQVFwQyxZQUFZLE1BQU07QUFDaEIsU0FBSyxPQUFPO0FBQUEsRUFDZDtBQUFBLEVBRUEsT0FBTyxNQUE4QjtBQUNuQyxXQUFPLEdBQUcsS0FBSyxRQUFRLEtBQUssUUFBUSxLQUFLLE1BQU0sS0FBSyxNQUFNO0FBQUEsRUFDNUQ7QUFBQSxFQUVBLFVBQWtCO0FBQ2hCLFdBQU8saUJBQWdCO0FBQUEsRUFDekI7QUFBQSxFQUVBLE9BQU8sU0FBUyxLQUE4QjtBQUM1QyxVQUFNLFFBQVEsSUFBSSxpQkFBZ0I7QUFDbEMsUUFBRyxPQUFPLFFBQVEsWUFBWSxlQUFlLFFBQVE7QUFDbkQsWUFBTSxPQUFPLElBQUksU0FBUztBQUMxQixZQUFNLE1BQU0sTUFBTSxLQUFLLE1BQU0sR0FBRyxFQUFFLElBQUk7QUFDdEMsVUFBRyxDQUFDLE1BQU0sRUFBRSxTQUFTLEdBQUcsR0FBRztBQUN6QixlQUFPLElBQUksZ0JBQWdCLE1BQU0sSUFBSTtBQUFBLE1BQ3ZDLFdBQ1EsQ0FBQyxPQUFPLEtBQUssRUFBRSxTQUFTLEdBQUcsR0FBRztBQUNwQyxlQUFPLElBQUksZ0JBQWdCLE1BQU0sSUFBSTtBQUFBLE1BQ3ZDLFdBQ1EsQ0FBQyxJQUFJLEVBQUUsU0FBUyxHQUFHLEdBQUc7QUFDNUIsZUFBTyxJQUFJLGVBQWUsTUFBTSxJQUFJO0FBQUEsTUFDdEM7QUFB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SyxTQUFTLFNBQVM7QUFDNUUsZUFBUyxNQUFNO0FBQ2YsV0FBSyxlQUFlO0FBQ3BCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxhQUFhO0FBQ1osU0FBSyxXQUFXLENBQUM7QUFDakIsU0FBSyxlQUFlO0FBQ3BCLFFBQUksd0JBQU8sMkJBQTJCO0FBQUEsRUFDdkM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sYUFBYSxNQUFxQjtBQUN2QyxRQUFJLEtBQUssS0FBSyxTQUFTLEtBQUssS0FBSyxLQUFLLEtBQUssV0FBVyxnQkFBZ0IsTUFBTSxHQUFHO0FBQzlFLFlBQU0sU0FBUyxLQUFLLEtBQUssTUFBTSxHQUFHLEVBQUUsQ0FBQztBQUVyQyxZQUFNLFdBQVcsTUFBTSxLQUFLLFlBQVk7QUFDeEMsaUJBQVcsS0FBSyxVQUFVO0FBQ3pCLGNBQU0sT0FBTyxFQUFFLE1BQU0sS0FBSyxPQUFLLEVBQUUsVUFBVSxNQUFNO0FBQ2pELGNBQU0sV0FBVyxLQUFLLEtBQUssUUFBUSxnQkFBZ0IsUUFBUSxFQUFFO0FBQzdELFlBQUksTUFBTTtBQUNULGdCQUFNLElBQUksS0FBSyxPQUFPLEtBQUssQ0FBQ0MsT0FBTUEsR0FBRSxRQUFRLFFBQVE7QUFDcEQsY0FBSSxHQUFHO0FBQ04sa0JBQU0sWUFBWSxLQUFLLFNBQVMsWUFBWSxLQUFLLFNBQVMsWUFBWTtBQUN0RSxrQkFBTSxNQUFNLDBCQUEwQixhQUFhLEtBQUssV0FBVyxFQUFFLFdBQVcsSUFBSSxLQUFLLEVBQUUsUUFBUTtBQUNuRyw0QkFBZ0IsaUJBQWlCLE1BQU0sR0FBRyxFQUFFLEtBQUssQ0FBQyxXQUFXO0FBQzVELG9CQUFNLE9BQU8sS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBRWhFLGtCQUFJLFVBQVUsTUFBTTtBQUNuQixxQkFBSyxPQUFPLGlCQUFpQixNQUFNO0FBQUEsY0FDcEM7QUFBQSxZQUNELENBQUM7QUFDRDtBQUFBLFVBQ0QsT0FBTztBQUNOLGdCQUFJLHdCQUFPLGlDQUFpQyxLQUFLLE9BQU87QUFBQSxVQUN6RDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFFRDtBQXJKQSxJQUFxQixtQkFBckI7QUFBcUIsaUJBRWIsZ0JBQWdCLE1BQU8sS0FBSyxLQUFLOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInBhY2siLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJhIl0KfQo=
